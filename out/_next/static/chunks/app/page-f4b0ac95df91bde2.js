(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[931],{3617:function(e,s,a){Promise.resolve().then(a.bind(a,8065))},8065:function(e,s,a){"use strict";a.r(s),a.d(s,{default:function(){return eA}});var l=a(7437),t=a(2265),i=a(9311),r=a(1271),n=a(2882),c=a(6020),d=a(6310),x=a(9409),o=a(2549),m=a(7972),h=a(5883),u=a(3023);let j=[{id:"sessions",label:"Numara Y\xf6netimi",icon:r.Z},{id:"conversations",label:"Mesajlar",icon:n.Z},{id:"bulk-message",label:"Toplu Mesaj",icon:c.Z},{id:"employees",label:"\xc7alışanlar",icon:d.Z,adminOnly:!0},{id:"settings",label:"Settings",icon:x.Z}];function f(e){let{activeTab:s,setActiveTab:a,closeSidebar:t,user:r,onLogout:c}=e,d=(null==r?void 0:r.user_type)==="admin";return(0,l.jsxs)("div",{className:"flex flex-col h-full bg-[#075E54] text-white",children:[(0,l.jsx)("div",{className:"p-6 border-b border-[#064e44]",children:(0,l.jsxs)("div",{className:"flex items-center justify-between",children:[(0,l.jsxs)("div",{className:"flex items-center space-x-3",children:[(0,l.jsx)("div",{className:"bg-white p-2 rounded-lg",children:(0,l.jsx)(n.Z,{className:"h-6 w-6 text-[#075E54]"})}),(0,l.jsxs)("div",{children:[(0,l.jsx)("h1",{className:"text-xl font-bold",children:"WhatsApp"}),(0,l.jsx)("p",{className:"text-sm text-green-100",children:"Marketing Dashboard"})]})]}),(0,l.jsx)("button",{onClick:t,className:"lg:hidden p-2 rounded-md hover:bg-[#064e44] transition-colors",children:(0,l.jsx)(o.Z,{className:"h-5 w-5"})})]})}),(0,l.jsx)("nav",{className:"flex-1 p-4 space-y-2",children:j.map(e=>{if(e.adminOnly&&!d)return null;let r=e.icon;return(0,l.jsxs)("button",{onClick:()=>{a(e.id),t()},className:(0,i.cn)("w-full flex items-center space-x-3 px-4 py-3 rounded-lg text-left transition-all duration-200",s===e.id?"bg-[#064e44] text-white shadow-lg":"text-green-100 hover:bg-[#064e44] hover:text-white"),children:[(0,l.jsx)(r,{className:"h-5 w-5"}),(0,l.jsx)("span",{className:"font-medium",children:e.label})]},e.id)})}),(0,l.jsxs)("div",{className:"p-4 border-t border-[#064e44] space-y-3",children:[r&&(0,l.jsxs)("div",{className:"flex items-center space-x-3 px-4 py-3 bg-[#064e44] rounded-lg",children:[(0,l.jsx)("div",{className:"bg-white p-2 rounded-full",children:(0,l.jsx)(m.Z,{className:"h-4 w-4 text-[#075E54]"})}),(0,l.jsxs)("div",{className:"flex-1",children:[(0,l.jsx)("p",{className:"text-sm font-medium",children:r.email}),(0,l.jsxs)("p",{className:"text-xs text-green-100",children:[r.user_type," - Aktif Oturum"]})]}),c&&(0,l.jsx)(u.z,{variant:"ghost",size:"sm",onClick:c,className:"text-red-200 hover:text-red-100 hover:bg-red-500/20 p-2",children:(0,l.jsx)(h.Z,{className:"h-4 w-4"})})]}),(0,l.jsxs)("div",{className:"flex items-center space-x-3 px-4 py-3",children:[(0,l.jsx)("div",{className:"bg-green-100 p-2 rounded-full",children:(0,l.jsx)("div",{className:"h-2 w-2 bg-green-600 rounded-full"})}),(0,l.jsxs)("div",{children:[(0,l.jsx)("p",{className:"text-sm font-medium",children:"System Status"}),(0,l.jsx)("p",{className:"text-xs text-green-100",children:"All systems operational"})]})]})]})]})}var g=a(4280),p=a(8063),N=a(9883),v=a(6110),y=a(2609),b=a(1908),w=a(6672),k=a(3546),S=a(6141),C=a(4530),Z=a(9727);function E(e){let{open:s,onOpenChange:a,onSessionAdded:i,existingSessionId:n}=e,[c,d]=(0,t.useState)("label"),[x,o]=(0,t.useState)(""),[m,h]=(0,t.useState)(""),[j,f]=(0,t.useState)(""),[N,v]=(0,t.useState)(120),[E,z]=(0,t.useState)(!1),[I,A]=(0,t.useState)(null),[M,_]=(0,t.useState)(null),T=(0,t.useRef)(null),O=(0,t.useRef)(null);(0,t.useEffect)(()=>{s&&n?(h(n),d("qr"),L()):s&&!n&&d("label")},[s,n]);let L=async()=>{if(n){z(!0),A(null);try{await D(n),v(120),B(n)}catch(e){console.error("Error connecting to existing session:",e),A("Mevcut session'a bağlanılamadı"),d("error")}finally{z(!1)}}},R=async()=>{z(!0),A(null);try{let e=x.trim();if(!e)throw Error("Session adı boş olamaz");h(e);let s=await (0,Z.ax)("/sessions",{method:"POST",body:JSON.stringify({name:e,start:!0,config:{metadata:{},proxy:null,debug:!1,noweb:{store:{enabled:!0,fullSync:!1}},webhooks:[]}})});if(!s.ok)throw Error("Session oluşturulamadı");let a=await s.json();_(a),await new Promise(e=>setTimeout(e,2e3)),await D(e),d("qr"),v(120),B(e)}catch(e){console.error("Error creating session:",e),A(e instanceof Error?e.message:"Bir hata oluştu"),d("error")}finally{z(!1)}},D=async e=>{try{let s=await (0,Z.ax)("/sessions/".concat(e,"/get-qr-code"),{method:"GET"});if(!s.ok)throw Error("QR kod alınamadı");let a=await s.blob(),l=URL.createObjectURL(a);f(l)}catch(e){console.error("Error fetching QR code:",e),A("QR kod alınamadı")}},B=e=>{T.current=setInterval(async()=>{try{let s=await (0,Z.ax)("/sessions/".concat(e));if(!s.ok)throw Error("Session durumu alınamadı");let a=await s.json();_(a),"WORKING"===a.status&&a.me?(d("connecting"),setTimeout(()=>{d("success");let e={id:a.name,name:a.name,phoneNumber:a.me.id.replace("@c.us",""),label:x,status:"connected",lastActivity:"Şimdi",messagesCount:0,pushName:a.me.pushName};setTimeout(()=>{i(e),P()},2e3)},2e3),T.current&&(clearInterval(T.current),T.current=null)):"FAILED"===a.status&&(A("Session bağlantısı başarısız"),d("error"),T.current&&(clearInterval(T.current),T.current=null))}catch(e){console.error("Error checking session status:",e)}},3e3)};(0,t.useEffect)(()=>{if("qr"===c&&N>0){let e=setInterval(()=>{v(e=>e<=1?(Y(),120):e-1)},1e3);return()=>clearInterval(e)}},[c,N]),(0,t.useEffect)(()=>{if("qr"===c&&m)return O.current=setInterval(()=>{Y()},12e4),()=>{O.current&&clearInterval(O.current)}},[c,m]);let Y=async()=>{m&&(z(!0),await D(m),v(120),z(!1))},P=()=>{d("label"),o(""),h(""),f(""),v(120),z(!1),A(null),_(null),T.current&&(clearInterval(T.current),T.current=null),O.current&&(clearInterval(O.current),O.current=null),j&&URL.revokeObjectURL(j)},K=()=>{a(!1),setTimeout(P,300)};return(0,l.jsx)(y.Vq,{open:s,onOpenChange:K,children:(0,l.jsxs)(y.cZ,{className:"sm:max-w-md",children:[(0,l.jsxs)(y.fK,{children:[(0,l.jsxs)(y.$N,{className:"flex items-center space-x-2",children:[(0,l.jsx)(r.Z,{className:"h-5 w-5 text-[#075E54]"}),(0,l.jsx)("span",{children:n?"Session'a Bağlan":"WhatsApp Numarası Ekle"})]}),(0,l.jsxs)(y.Be,{children:["label"===c&&"WhatsApp session'ınıza bir isim verin","qr"===c&&(n?"Mevcut session'a bağlanmak i\xe7in QR kodu tarayın":"WhatsApp ile bağlanmak i\xe7in QR kodu tarayın"),"connecting"===c&&"WhatsApp'ınız bağlanıyor...","success"===c&&"Başarıyla bağlandı!","error"===c&&"Bir hata oluştu"]})]}),(0,l.jsxs)("div",{className:"space-y-6",children:["label"===c&&(0,l.jsxs)("div",{className:"space-y-4",children:[(0,l.jsxs)("div",{className:"space-y-2",children:[(0,l.jsx)(w._,{htmlFor:"label",children:"Session Etiketi"}),(0,l.jsx)(b.I,{id:"label",placeholder:"\xf6r: Satış Ekibi, M\xfcşteri Desteği",value:x,onChange:e=>o(e.target.value)})]}),(0,l.jsxs)("div",{className:"flex justify-end space-x-2",children:[(0,l.jsx)(u.z,{variant:"outline",onClick:K,children:"İptal"}),(0,l.jsx)(u.z,{onClick:R,className:"bg-[#075E54] hover:bg-[#064e44]",disabled:!x.trim()||E,children:E?(0,l.jsxs)(l.Fragment,{children:[(0,l.jsx)(g.Z,{className:"h-4 w-4 mr-2 animate-spin"}),"Oluşturuluyor..."]}):"QR Kod Oluştur"})]})]}),"qr"===c&&(0,l.jsx)("div",{className:"text-center space-y-4",children:E?(0,l.jsxs)("div",{className:"flex flex-col items-center space-y-4",children:[(0,l.jsx)("div",{className:"animate-spin rounded-full h-16 w-16 border-4 border-gray-200 border-t-[#075E54]"}),(0,l.jsx)("p",{className:"text-gray-600",children:"QR kod yenileniyor..."})]}):(0,l.jsxs)(l.Fragment,{children:[(0,l.jsx)("div",{className:"bg-gray-50 p-6 rounded-lg",children:j?(0,l.jsx)("img",{src:j,alt:"WhatsApp QR Kodu",className:"mx-auto rounded-lg shadow-sm",width:200,height:200}):(0,l.jsx)("div",{className:"w-[200px] h-[200px] bg-gray-200 rounded-lg flex items-center justify-center mx-auto",children:(0,l.jsx)(k.Z,{className:"h-16 w-16 text-gray-400"})})}),(0,l.jsxs)("div",{className:"space-y-2",children:[(0,l.jsxs)("div",{className:"flex items-center justify-center space-x-2 text-sm text-gray-600",children:[(0,l.jsx)(S.Z,{className:"h-4 w-4"}),(0,l.jsxs)("span",{children:["".concat(Math.floor(N/60),":").concat((N%60).toString().padStart(2,"0"))," i\xe7inde yenilenecek"]})]}),M&&(0,l.jsxs)("div",{className:"flex items-center justify-center space-x-2 text-sm",children:[(0,l.jsx)("span",{className:"text-gray-600",children:"Durum:"}),(0,l.jsx)("span",{className:"font-medium ".concat("WORKING"===M.status?"text-green-600":"SCAN_QR_CODE"===M.status?"text-yellow-600":"FAILED"===M.status?"text-red-600":"text-gray-600"),children:M.status})]}),(0,l.jsxs)("div",{className:"bg-blue-50 p-3 rounded-lg text-sm text-blue-800",children:[(0,l.jsx)("p",{className:"font-medium",children:"Talimatlar:"}),(0,l.jsxs)("ol",{className:"mt-2 space-y-1 text-left",children:[(0,l.jsx)("li",{children:"1. Telefonunuzda WhatsApp'ı a\xe7ın"}),(0,l.jsx)("li",{children:"2. Men\xfc → Bağlı Cihazlar'a dokunun"}),(0,l.jsx)("li",{children:'3. "Cihaz Bağla"ya dokunun'}),(0,l.jsx)("li",{children:"4. Bu QR kodu tarayın"})]})]})]}),(0,l.jsxs)("div",{className:"flex justify-center space-x-2",children:[(0,l.jsxs)(u.z,{variant:"outline",onClick:Y,disabled:E,children:[(0,l.jsx)(g.Z,{className:"h-4 w-4 mr-2"}),"QR Yenile"]}),(0,l.jsx)(u.z,{variant:"outline",onClick:K,children:"İptal"})]})]})}),"connecting"===c&&(0,l.jsxs)("div",{className:"text-center space-y-4",children:[(0,l.jsx)("div",{className:"animate-spin rounded-full h-16 w-16 border-4 border-gray-200 border-t-[#075E54] mx-auto"}),(0,l.jsxs)("div",{children:[(0,l.jsx)("p",{className:"font-medium text-gray-900",children:"Bağlanıyor..."}),(0,l.jsx)("p",{className:"text-sm text-gray-600",children:"L\xfctfen bağlantı kurulurken bekleyin"}),M&&M.me&&(0,l.jsxs)("p",{className:"text-sm text-green-600 mt-2",children:["+",M.me.id.replace("@c.us","")," bağlandı"]})]})]}),"success"===c&&(0,l.jsxs)("div",{className:"text-center space-y-4",children:[(0,l.jsx)("div",{className:"bg-green-100 rounded-full p-4 w-16 h-16 mx-auto flex items-center justify-center",children:(0,l.jsx)(C.Z,{className:"h-8 w-8 text-green-600"})}),(0,l.jsxs)("div",{children:[(0,l.jsx)("p",{className:"font-medium text-gray-900",children:"Başarıyla Bağlandı!"}),(0,l.jsxs)("p",{className:"text-sm text-gray-600",children:["WhatsApp session'ınız \"",x,'" artık aktif']}),M&&M.me&&(0,l.jsxs)("p",{className:"text-sm text-gray-500 mt-1",children:["Numara: +",M.me.id.replace("@c.us","")]})]})]}),"error"===c&&(0,l.jsxs)("div",{className:"text-center space-y-4",children:[(0,l.jsx)("div",{className:"bg-red-100 rounded-full p-4 w-16 h-16 mx-auto flex items-center justify-center",children:(0,l.jsx)(p.Z,{className:"h-8 w-8 text-red-600"})}),(0,l.jsxs)("div",{children:[(0,l.jsx)("p",{className:"font-medium text-gray-900",children:"Hata Oluştu"}),(0,l.jsx)("p",{className:"text-sm text-red-600",children:I})]}),(0,l.jsxs)("div",{className:"flex justify-center space-x-2",children:[(0,l.jsx)(u.z,{variant:"outline",onClick:()=>{d("label"),A(null)},children:"Tekrar Dene"}),(0,l.jsx)(u.z,{variant:"outline",onClick:K,children:"İptal"})]})]})]})]})})}var z=a(9155),I=a(7305),A=a(7158),M=a(2442),_=a(6369);let T=I.fC,O=I.xz;I.ZA,I.Uv,I.Tr,I.Ee;let L=t.forwardRef((e,s)=>{let{className:a,inset:t,children:r,...n}=e;return(0,l.jsxs)(I.fF,{ref:s,className:(0,i.cn)("flex cursor-default select-none items-center rounded-sm px-2 py-1.5 text-sm outline-none focus:bg-accent data-[state=open]:bg-accent",t&&"pl-8",a),...n,children:[r,(0,l.jsx)(A.Z,{className:"ml-auto h-4 w-4"})]})});L.displayName=I.fF.displayName;let R=t.forwardRef((e,s)=>{let{className:a,...t}=e;return(0,l.jsx)(I.tu,{ref:s,className:(0,i.cn)("z-50 min-w-[8rem] overflow-hidden rounded-md border bg-popover p-1 text-popover-foreground shadow-lg data-[state=open]:animate-in data-[state=closed]:animate-out data-[state=closed]:fade-out-0 data-[state=open]:fade-in-0 data-[state=closed]:zoom-out-95 data-[state=open]:zoom-in-95 data-[side=bottom]:slide-in-from-top-2 data-[side=left]:slide-in-from-right-2 data-[side=right]:slide-in-from-left-2 data-[side=top]:slide-in-from-bottom-2",a),...t})});R.displayName=I.tu.displayName;let D=t.forwardRef((e,s)=>{let{className:a,sideOffset:t=4,...r}=e;return(0,l.jsx)(I.Uv,{children:(0,l.jsx)(I.VY,{ref:s,sideOffset:t,className:(0,i.cn)("z-50 min-w-[8rem] overflow-hidden rounded-md border bg-popover p-1 text-popover-foreground shadow-md data-[state=open]:animate-in data-[state=closed]:animate-out data-[state=closed]:fade-out-0 data-[state=open]:fade-in-0 data-[state=closed]:zoom-out-95 data-[state=open]:zoom-in-95 data-[side=bottom]:slide-in-from-top-2 data-[side=left]:slide-in-from-right-2 data-[side=right]:slide-in-from-left-2 data-[side=top]:slide-in-from-bottom-2",a),...r})})});D.displayName=I.VY.displayName;let B=t.forwardRef((e,s)=>{let{className:a,inset:t,...r}=e;return(0,l.jsx)(I.ck,{ref:s,className:(0,i.cn)("relative flex cursor-default select-none items-center rounded-sm px-2 py-1.5 text-sm outline-none transition-colors focus:bg-accent focus:text-accent-foreground data-[disabled]:pointer-events-none data-[disabled]:opacity-50",t&&"pl-8",a),...r})});B.displayName=I.ck.displayName;let Y=t.forwardRef((e,s)=>{let{className:a,children:t,checked:r,...n}=e;return(0,l.jsxs)(I.oC,{ref:s,className:(0,i.cn)("relative flex cursor-default select-none items-center rounded-sm py-1.5 pl-8 pr-2 text-sm outline-none transition-colors focus:bg-accent focus:text-accent-foreground data-[disabled]:pointer-events-none data-[disabled]:opacity-50",a),checked:r,...n,children:[(0,l.jsx)("span",{className:"absolute left-2 flex h-3.5 w-3.5 items-center justify-center",children:(0,l.jsx)(I.wU,{children:(0,l.jsx)(M.Z,{className:"h-4 w-4"})})}),t]})});Y.displayName=I.oC.displayName;let P=t.forwardRef((e,s)=>{let{className:a,children:t,...r}=e;return(0,l.jsxs)(I.Rk,{ref:s,className:(0,i.cn)("relative flex cursor-default select-none items-center rounded-sm py-1.5 pl-8 pr-2 text-sm outline-none transition-colors focus:bg-accent focus:text-accent-foreground data-[disabled]:pointer-events-none data-[disabled]:opacity-50",a),...r,children:[(0,l.jsx)("span",{className:"absolute left-2 flex h-3.5 w-3.5 items-center justify-center",children:(0,l.jsx)(I.wU,{children:(0,l.jsx)(_.Z,{className:"h-2 w-2 fill-current"})})}),t]})});P.displayName=I.Rk.displayName;let K=t.forwardRef((e,s)=>{let{className:a,inset:t,...r}=e;return(0,l.jsx)(I.__,{ref:s,className:(0,i.cn)("px-2 py-1.5 text-sm font-semibold",t&&"pl-8",a),...r})});K.displayName=I.__.displayName;let F=t.forwardRef((e,s)=>{let{className:a,...t}=e;return(0,l.jsx)(I.Z0,{ref:s,className:(0,i.cn)("-mx-1 my-1 h-px bg-muted",a),...t})});F.displayName=I.Z0.displayName;var Q=a(3759),G=a(9039),W=a(9534),H=a(5432);function q(e){var s,a,i,n,c,d,x,o,m,h,j,f,g;let{sessionId:N,sessionData:y,onRemove:b,onRestart:w,onReconnect:k,onStop:S,onLogout:C}=e,[E,I]=(0,t.useState)(null),[A,M]=(0,t.useState)(!0),_=async()=>{if(!y)try{M(!0);let e=await (0,Z.ax)("/sessions/".concat(N));if(!e.ok)throw Error("Session alınamadı");let s=await e.json(),a=R(s);I(a)}catch(e){}finally{M(!1)}};(0,t.useEffect)(()=>{if(y){let e=R(y);I(e),M(!1)}else _()},[y,N]);let L=async(e,s)=>{await e(),y||(s?setTimeout(()=>{_()},s):_())};if(A&&!E)return(0,l.jsxs)(v.Zb,{className:"animate-pulse",children:[(0,l.jsx)(v.Ol,{className:"pb-3",children:(0,l.jsx)("div",{className:"flex items-center justify-between",children:(0,l.jsxs)("div",{className:"flex items-center space-x-3",children:[(0,l.jsx)("div",{className:"bg-[#075E54] p-2 rounded-lg",children:(0,l.jsx)(r.Z,{className:"h-4 w-4 text-white"})}),(0,l.jsxs)("div",{children:[(0,l.jsx)(v.ll,{className:"text-lg bg-gray-200 w-32 h-4 rounded"}),(0,l.jsx)(v.SZ,{className:"text-sm bg-gray-100 w-24 h-3 rounded mt-2"})]})]})})}),(0,l.jsx)(v.aY,{children:(0,l.jsx)("div",{className:"space-y-4",children:(0,l.jsx)("div",{className:"flex items-center justify-between",children:(0,l.jsxs)("div",{className:"flex items-center space-x-2",children:[(0,l.jsx)(p.Z,{className:"h-4 w-4 text-gray-300"}),(0,l.jsx)(z.C,{className:"bg-gray-100 text-gray-400",children:"Y\xfckleniyor..."})]})})})})]});if(!E)return null;function R(e){return e.me&&e.me.id?{id:e.name,phoneNumber:e.me.id.replace("@c.us",""),label:e.me.pushName||e.name,status:"WORKING"===e.status?"connected":"STOPPED"===e.status?"stopped":"FAILED"===e.status?"failed":(e.status,"disconnected"),lastActivity:"Bug\xfcn",messagesCount:Math.floor(1e3*Math.random()),originalData:e}:{id:e.name,phoneNumber:"Hen\xfcz bağlanmadı",label:e.name,status:"SCAN_QR_CODE"===e.status?"disconnected":"STARTING"===e.status?"disconnected":"STOPPED"===e.status?"stopped":"FAILED"===e.status?"failed":"expired",lastActivity:"STARTING"===e.status?"Başlatılıyor...":"Bağlantı bekleniyor",messagesCount:0,originalData:e}}return(0,l.jsxs)(v.Zb,{className:"hover:shadow-lg transition-shadow duration-200",children:[(0,l.jsx)(v.Ol,{className:"pb-3",children:(0,l.jsxs)("div",{className:"flex items-center justify-between",children:[(0,l.jsxs)("div",{className:"flex items-center space-x-3",children:[(0,l.jsx)("div",{className:"bg-[#075E54] p-2 rounded-lg",children:(0,l.jsx)(r.Z,{className:"h-4 w-4 text-white"})}),(0,l.jsxs)("div",{children:[(0,l.jsx)(v.ll,{className:"text-lg",children:"Hen\xfcz bağlanmadı"===E.phoneNumber?E.label:"+".concat(E.phoneNumber)}),(0,l.jsx)(v.SZ,{className:"text-sm",children:"Hen\xfcz bağlanmadı"===E.phoneNumber?"Bağlantı bekleniyor":E.label})]})]}),(0,l.jsxs)(T,{children:[(0,l.jsx)(O,{asChild:!0,children:(0,l.jsx)(u.z,{variant:"ghost",size:"sm",children:(0,l.jsx)(W.Z,{className:"h-4 w-4"})})}),(0,l.jsx)(D,{align:"end",children:(null===(s=E.originalData)||void 0===s?void 0:s.status)==="WORKING"?(0,l.jsxs)(l.Fragment,{children:[(0,l.jsx)(B,{onClick:()=>L(()=>S(E.id)),children:"Durdur"}),(0,l.jsx)(B,{onClick:()=>L(()=>C(E.id)),children:"\xc7ıkış Yap"}),(0,l.jsxs)(B,{onClick:()=>L(()=>w(E.id),3e3),children:[(0,l.jsx)(H.Z,{className:"h-4 w-4 mr-2"}),"Yeniden Başlat"]}),(0,l.jsx)(B,{onClick:()=>L(()=>b(E.id)),className:"text-red-600",children:"Kaldır"})]}):(null===(a=E.originalData)||void 0===a?void 0:a.status)==="STOPPED"?(0,l.jsxs)(l.Fragment,{children:[(0,l.jsxs)(B,{onClick:()=>L(()=>w(E.id)),children:[(0,l.jsx)(H.Z,{className:"h-4 w-4 mr-2"}),"Yeniden Başlat"]}),(0,l.jsx)(B,{onClick:()=>L(()=>b(E.id)),className:"text-red-600",children:"Kaldır"})]}):(null===(i=E.originalData)||void 0===i?void 0:i.status)==="STARTING"?(0,l.jsxs)(l.Fragment,{children:[(0,l.jsx)(B,{disabled:!0,children:"Başlatılıyor..."}),(0,l.jsx)(B,{onClick:()=>L(()=>S(E.id)),children:"Durdur"}),(0,l.jsx)(B,{onClick:()=>L(()=>b(E.id)),className:"text-red-600",children:"Kaldır"})]}):(null===(n=E.originalData)||void 0===n?void 0:n.status)==="SCAN_QR_CODE"?(0,l.jsxs)(l.Fragment,{children:[(0,l.jsx)(B,{onClick:()=>L(()=>k(E.id)),children:"QR ile Bağlan"}),(0,l.jsxs)(B,{onClick:()=>L(()=>w(E.id)),children:[(0,l.jsx)(H.Z,{className:"h-4 w-4 mr-2"}),"Yeniden Başlat"]}),(0,l.jsx)(B,{onClick:()=>L(()=>b(E.id)),className:"text-red-600",children:"Kaldır"})]}):(null===(c=E.originalData)||void 0===c?void 0:c.status)==="FAILED"?(0,l.jsxs)(l.Fragment,{children:[(0,l.jsxs)(B,{onClick:()=>L(()=>w(E.id),3e3),children:[(0,l.jsx)(H.Z,{className:"h-4 w-4 mr-2"}),"Yeniden Başlat"]}),(0,l.jsx)(B,{onClick:()=>L(()=>C(E.id)),children:"\xc7ıkış Yap ve Yeniden Başlat"}),(0,l.jsx)(B,{onClick:()=>L(()=>b(E.id)),className:"text-red-600",children:"Kaldır"})]}):(0,l.jsxs)(l.Fragment,{children:[(0,l.jsxs)(B,{onClick:()=>L(()=>w(E.id),3e3),children:[(0,l.jsx)(H.Z,{className:"h-4 w-4 mr-2"}),"Yeniden Başlat"]}),(0,l.jsx)(B,{onClick:()=>L(()=>b(E.id)),className:"text-red-600",children:"Kaldır"})]})})]})]})}),(0,l.jsx)(v.aY,{children:(0,l.jsxs)("div",{className:"space-y-4",children:[(0,l.jsx)("div",{className:"flex items-center justify-between",children:(0,l.jsxs)("div",{className:"flex items-center space-x-2",children:[(e=>{switch(e){case"connected":return(0,l.jsx)(Q.Z,{className:"h-4 w-4 text-green-600"});case"disconnected":return(0,l.jsx)(G.Z,{className:"h-4 w-4 text-yellow-600"});case"expired":return(0,l.jsx)(p.Z,{className:"h-4 w-4 text-red-600"});case"stopped":return(0,l.jsx)(p.Z,{className:"h-4 w-4 text-orange-600"});case"failed":return(0,l.jsx)(p.Z,{className:"h-4 w-4 text-pink-600"});default:return(0,l.jsx)(p.Z,{className:"h-4 w-4 text-gray-400"})}})(E.status),(0,l.jsx)(z.C,{className:(e=>{switch(e){case"connected":return"bg-green-100 text-green-800";case"disconnected":return"bg-yellow-100 text-yellow-800";case"expired":return"bg-red-100 text-red-800";case"stopped":return"bg-orange-100 text-orange-800";case"failed":return"bg-pink-100 text-pink-800";default:return"bg-gray-100 text-gray-800"}})(E.status),children:(null===(d=E.originalData)||void 0===d?void 0:d.status)==="WORKING"?"Bağlı":(null===(x=E.originalData)||void 0===x?void 0:x.status)==="STOPPED"?"Durduruldu":(null===(o=E.originalData)||void 0===o?void 0:o.status)==="STARTING"?"Başlatılıyor":(null===(m=E.originalData)||void 0===m?void 0:m.status)==="SCAN_QR_CODE"?"QR Bekliyor":(null===(h=E.originalData)||void 0===h?void 0:h.status)==="FAILED"?"Hata":"connected"===E.status?"Bağlı":"disconnected"===E.status?"Bağlantı Kesildi":"stopped"===E.status?"Durduruldu":"failed"===E.status?"Hata":"S\xfcresi Doldu"})]})}),(0,l.jsxs)("div",{className:"space-y-2",children:[(0,l.jsxs)("div",{className:"flex justify-between text-sm",children:[(0,l.jsx)("span",{className:"text-gray-600",children:"Son Aktivite"}),(0,l.jsx)("span",{className:"font-medium",children:E.lastActivity})]}),(0,l.jsxs)("div",{className:"flex justify-between text-sm",children:[(0,l.jsx)("span",{className:"text-gray-600",children:"G\xf6nderilen Mesaj"}),(0,l.jsx)("span",{className:"font-medium",children:E.messagesCount.toString().replace(/\B(?=(\d{3})+(?!\d))/g,",")})]}),(null===(f=E.originalData)||void 0===f?void 0:null===(j=f.me)||void 0===j?void 0:j.pushName)&&(0,l.jsxs)("div",{className:"flex justify-between text-sm",children:[(0,l.jsx)("span",{className:"text-gray-600",children:"Profil Adı"}),(0,l.jsx)("span",{className:"font-medium",children:E.originalData.me.pushName})]}),(null===(g=E.originalData)||void 0===g?void 0:g.status)&&(0,l.jsxs)("div",{className:"flex justify-between text-sm",children:[(0,l.jsx)("span",{className:"text-gray-600",children:"API Durumu"}),(0,l.jsx)("span",{className:"font-medium text-xs bg-gray-100 px-2 py-1 rounded",children:E.originalData.status})]})]})]})})]})}function U(e){let{user:s}=e,[a,i]=(0,t.useState)([]),[n,c]=(0,t.useState)(!0),[d,x]=(0,t.useState)(null),[o,m]=(0,t.useState)(!1),[h,j]=(0,t.useState)(void 0),[f,b]=(0,t.useState)(null),[w,k]=(0,t.useState)(!1),[S,C]=(0,t.useState)(null),[z,I]=(0,t.useState)(null),[A,M]=(0,t.useState)(new Set),_=async()=>{try{let e,a,l,t;if(c(!0),x(null),(null==s?void 0:s.user_type)==="admin"?(console.log("Admin ise t\xfcm istekleri at"),[e,a,l,t]=await Promise.all([(0,Z.ax)("/sessions"),(0,Z.ax)("/company/session-counts"),(0,Z.ax)("/company/me"),(0,Z.ax)("/company/users")])):(console.log("Normal user ise sadece session ve count istekleri at"),[e,a]=await Promise.all([(0,Z.ax)("/sessions"),(0,Z.ax)("/company/session-counts")]),l={ok:!1},t={ok:!1}),!e.ok)throw Error("HTTP error! status: ".concat(e.status));let r=await e.json();i(r);let n=new Set;if(r.forEach(e=>{"STARTING"===e.status&&n.add(e.name)}),M(n),l&&l.ok){let e=await l.json();C(e)}if(t&&t.ok&&await t.json(),a&&a.ok){let e=await a.json();I(e)}}catch(e){x(e instanceof Error?e.message:"Bir hata oluştu")}finally{c(!1)}};(0,t.useEffect)(()=>{if(A.size>0){let e=setInterval(()=>{_()},2e3);return()=>clearInterval(e)}},[A]),(0,t.useEffect)(()=>{_()},[]);let T=async e=>{try{let s=await (0,Z.ax)("/sessions/".concat(e),{method:"DELETE"});s.ok&&i(a.filter(s=>s.name!==e))}catch(e){console.error("Error removing session:",e)}},O=async e=>{try{await (0,Z.ax)("/sessions/".concat(e,"/restart"),{method:"POST"})}catch(e){console.error("Error restarting session:",e)}},L=e=>{j(e),m(!0)},R=async e=>{try{await (0,Z.ax)("/sessions/".concat(e,"/stop"),{method:"POST"})}catch(e){console.error("Error stopping session:",e)}},D=async e=>{try{await (0,Z.ax)("/sessions/".concat(e,"/logout"),{method:"POST"})}catch(e){console.error("Error logging out session:",e)}},B=!!z&&void 0!==z.count&&void 0!==z.session_limit&&z.count>=z.session_limit,Y=()=>{b(null),j(void 0),m(!0)};return n?(0,l.jsx)("div",{className:"h-full flex items-center justify-center",children:(0,l.jsxs)("div",{className:"text-center",children:[(0,l.jsx)(g.Z,{className:"h-8 w-8 animate-spin text-gray-400 mx-auto mb-4"}),(0,l.jsx)("span",{className:"text-gray-600",children:"Session bilgileri y\xfckleniyor..."})]})}):d?(0,l.jsx)("div",{className:"h-full flex items-center justify-center",children:(0,l.jsxs)("div",{className:"text-center",children:[(0,l.jsx)(p.Z,{className:"h-12 w-12 text-red-500 mx-auto mb-4"}),(0,l.jsx)("h3",{className:"text-lg font-medium text-gray-900 mb-2",children:"Bağlantı Hatası"}),(0,l.jsx)("p",{className:"text-gray-600 mb-4",children:d}),(0,l.jsxs)(u.z,{onClick:_,className:"bg-[#075E54] hover:bg-[#064e44]",children:[(0,l.jsx)(g.Z,{className:"h-4 w-4 mr-2"}),"Tekrar Dene"]})]})}):(0,l.jsx)("div",{className:"h-full overflow-y-auto",children:(0,l.jsxs)("div",{className:"p-8",children:[(0,l.jsx)("div",{className:"mb-8",children:(0,l.jsxs)("div",{className:"flex items-center justify-between",children:[(0,l.jsxs)("div",{children:[(0,l.jsx)("h1",{className:"text-3xl font-bold text-gray-900 mb-2",children:"Session Manager"}),(0,l.jsx)("p",{className:"text-gray-600",children:"WhatsApp iş numaralarınızı ve bağlantılarınızı y\xf6netin"})]}),(0,l.jsxs)(u.z,{onClick:_,variant:"outline",size:"sm",children:[(0,l.jsx)(g.Z,{className:"h-4 w-4 mr-2"}),"Yenile"]})]})}),(0,l.jsxs)("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-6 mb-8",children:[(0,l.jsxs)(v.Zb,{children:[(0,l.jsx)(v.Ol,{className:"pb-3",children:(0,l.jsx)(v.ll,{className:"text-sm font-medium text-gray-600",children:"Aktif Sessionlar"})}),(0,l.jsx)(v.aY,{children:(0,l.jsx)("div",{className:"text-2xl font-bold text-green-600",children:a.filter(e=>"WORKING"===e.status).length})})]}),(0,l.jsxs)(v.Zb,{children:[(0,l.jsx)(v.Ol,{className:"pb-3",children:(0,l.jsx)(v.ll,{className:"text-sm font-medium text-gray-600",children:"Pasif Sessionlar"})}),(0,l.jsx)(v.aY,{children:(0,l.jsx)("div",{className:"text-2xl font-bold text-orange-600",children:a.filter(e=>"WORKING"!==e.status).length})})]})]}),(0,l.jsxs)("div",{className:"mb-6 flex items-center space-x-3",children:[(0,l.jsxs)(u.z,{onClick:Y,className:"bg-[#075E54] hover:bg-[#064e44] text-white ".concat(B?"opacity-50 cursor-not-allowed":""),size:"lg",disabled:B,children:[(0,l.jsx)(N.Z,{className:"h-5 w-5 mr-2"}),"Yeni WhatsApp Numarası Ekle"]}),B&&(0,l.jsxs)("div",{className:"flex items-center space-x-2 text-red-600 text-sm",children:[(0,l.jsx)(p.Z,{className:"h-5 w-5"}),(0,l.jsx)("span",{children:(null==s?void 0:s.user_type)==="admin"?"Session limitine ulaşıldı":"Session limitine ulaşıldı, l\xfctfen admin ile konuşun"})]})]}),(0,l.jsx)("div",{className:"grid grid-cols-1 lg:grid-cols-2 xl:grid-cols-3 gap-6",children:a.map(e=>(0,l.jsx)(q,{sessionId:e.name,sessionData:e,onRemove:T,onRestart:O,onReconnect:L,onStop:R,onLogout:D},e.name))}),0===a.length&&!n&&(0,l.jsxs)("div",{className:"text-center py-12",children:[(0,l.jsx)(r.Z,{className:"h-16 w-16 text-gray-400 mx-auto mb-4"}),(0,l.jsx)("h3",{className:"text-lg font-medium text-gray-900 mb-2",children:"Hen\xfcz WhatsApp sessionu yok"}),(0,l.jsx)("p",{className:"text-gray-600 mb-6",children:"İlk WhatsApp iş numaranızı ekleyerek başlayın"}),(0,l.jsxs)("div",{className:"flex items-center justify-center space-x-3",children:[(0,l.jsxs)(u.z,{onClick:Y,className:"bg-[#075E54] hover:bg-[#064e44] text-white ".concat(B?"opacity-50 cursor-not-allowed":""),disabled:B,children:[(0,l.jsx)(N.Z,{className:"h-5 w-5 mr-2"}),"İlk Numaranızı Ekleyin"]}),B&&(0,l.jsxs)("div",{className:"flex items-center space-x-2 text-red-600 text-sm",children:[(0,l.jsx)(p.Z,{className:"h-5 w-5"}),(0,l.jsx)("span",{children:(null==s?void 0:s.user_type)==="admin"?"Session limitine ulaşıldı":"Session limitine ulaşıldı, l\xfctfen admin ile konuşun"})]})]})]}),(0,l.jsx)(E,{open:o,onOpenChange:e=>{m(e),e||j(void 0)},onSessionAdded:e=>{_(),m(!1),j(void 0)},existingSessionId:h}),f&&(0,l.jsx)("div",{className:"my-4 p-3 bg-red-100 border border-red-300 text-red-700 rounded",children:f}),(0,l.jsx)(y.Vq,{open:w,onOpenChange:k,children:(0,l.jsxs)(y.cZ,{children:[(0,l.jsx)(y.fK,{children:(0,l.jsx)(y.$N,{children:"Session Limiti Doldu"})}),(0,l.jsx)("div",{className:"text-red-700 mb-2",children:f||"Limit dolu, admin ile iletişime ge\xe7in."}),(0,l.jsx)(u.z,{onClick:()=>k(!1),className:"bg-[#075E54] text-white mt-2",children:"Tamam"})]})})]})})}var V=a(1827),$=a(1720),X=a(4698),J=a(1243),ee=a(890),es=a(3714),ea=a(6489),el=a(7309);let et=t.forwardRef((e,s)=>{let{className:a,...t}=e;return(0,l.jsx)("textarea",{className:(0,i.cn)("flex min-h-[80px] w-full rounded-md border border-input bg-background px-3 py-2 text-sm ring-offset-background placeholder:text-muted-foreground focus-visible:outline-none focus-visible:ring-2 focus-visible:ring-ring focus-visible:ring-offset-2 disabled:cursor-not-allowed disabled:opacity-50",a),ref:s,...t})});et.displayName="Textarea";var ei=a(8094);function er(){let[e,s]=(0,t.useState)(null),[a,r]=(0,t.useState)(""),[d,x]=(0,t.useState)("all"),[o,m]=(0,t.useState)(""),[h,j]=(0,t.useState)(!1),[f,v]=(0,t.useState)(""),[k,C]=(0,t.useState)(""),[E,I]=(0,t.useState)(!1),[A,M]=(0,t.useState)([]),[_,L]=(0,t.useState)([]),[R,Y]=(0,t.useState)([]),[P,K]=(0,t.useState)(!0),[F,Q]=(0,t.useState)(!1),[G,H]=(0,t.useState)(null),[q,U]=(0,t.useState)(!1),er=async()=>{try{let e=await (0,Z.ax)("/sessions");if(!e.ok)throw Error("Session verileri alınamadı");let s=await e.json(),a=s.map((e,s)=>e.me&&e.me.id?{id:e.name,name:e.name,label:e.me.pushName||"Session ".concat(s+1),phone:e.me.id.replace("@c.us","")}:null).filter(Boolean);M(a),a.length>0&&!k&&C(a[0].id)}catch(e){console.error("Error fetching sessions:",e),H("Session verileri alınamadı")}},en=async e=>{try{K(!0);let s=await (0,Z.ax)("/chats/".concat(e,"/overview"));if(!s.ok)throw Error("Konuşma verileri alınamadı");let a=await s.json(),l=a.map((s,a)=>{var l,t;let i=s.id.replace("@c.us",""),r=s.name||i,n=new Date(1e3*s.lastMessage.timestamp),c=ex(n);return{id:"".concat(e,"_").concat(s.id),name:r,phone:"+".concat(i),avatar:s.picture||void 0,lastMessage:s.lastMessage.body||"Media mesajı",timestamp:c,unreadCount:0,sessionLabel:(null===(l=A.find(s=>s.id===e))||void 0===l?void 0:l.label)||e,sessionPhone:(null===(t=A.find(s=>s.id===e))||void 0===t?void 0:t.phone)||"",sessionId:e,isOnline:!1,isPinned:!1,isMuted:!1,isArchived:!1,rawChatId:s.id,lastMessageAck:s.lastMessage.ack,lastMessageId:s.lastMessage.id,lastMessageTimestamp:s.lastMessage.timestamp}});L(l),H(null)}catch(e){console.error("Error fetching chats:",e),H("Konuşma verileri alınamadı")}finally{K(!1)}},ec=async(e,s,a)=>{try{Q(!0);let l=await (0,Z.ax)("/chats/".concat(e,"/").concat(s,"/messages"));if(!l.ok)throw Error("Mesajlar alınamadı");let t=await l.json(),i=t.map(e=>{let s=new Date(1e3*e.timestamp),l=s.toLocaleTimeString("tr-TR",{hour:"2-digit",minute:"2-digit"}),t="sent";2===e.ack&&(t="delivered"),3===e.ack&&(t="read");let i="text";return e.hasMedia&&(i="image"),{id:e.id,contactId:a,content:e.body,timestamp:l,isOutgoing:e.fromMe,status:t,type:i,rawId:e.id}}).reverse();Y(i)}catch(e){console.error("Error fetching messages:",e)}finally{Q(!1)}},ed=async(s,a,l)=>{try{U(!0);let t=await (0,Z.ax)("/send-text",{method:"POST",body:JSON.stringify({chatId:s,reply_to:null,text:l,linkPreview:!0,linkPreviewHighQuality:!1,session:a})});if(!t.ok)throw Error("Mesaj g\xf6nderilemedi");let i=await t.json();if(e){let s=_.find(s=>s.id===e);s&&await ec(s.sessionId,s.rawChatId,s.id)}return i}catch(e){throw console.error("Error sending message:",e),e}finally{U(!1)}},ex=e=>{let s=new Date,a=Math.floor((s.getTime()-e.getTime())/6e4);if(a<1)return"Şimdi";if(a<60)return"".concat(a," dk \xf6nce");let l=Math.floor(a/60);if(l<24)return"".concat(l," saat \xf6nce");let t=Math.floor(l/24);return 1===t?"D\xfcn":t<7?"".concat(t," g\xfcn \xf6nce"):e.toLocaleDateString("tr-TR")};(0,t.useEffect)(()=>{er()},[]),(0,t.useEffect)(()=>{"ALL"===k&&eo("ALL")},[A]),(0,t.useEffect)(()=>{if(e){let s=_.find(s=>s.id===e);s&&ec(s.sessionId,s.rawChatId,s.id)}},[e]);let eo=async e=>{if(C(e),s(null),Y([]),"ALL"===e){I(!0),K(!0),H(null);try{let e=[];for(let s of A){let a=await (0,Z.ax)("/chats/".concat(s.id,"/overview"));if(a.ok){let l=await a.json(),t=l.map((e,a)=>{let l=e.id.replace("@c.us",""),t=e.name||l,i=new Date(1e3*e.lastMessage.timestamp),r=ex(i);return{id:"".concat(s.id,"_").concat(e.id),name:t,phone:"+".concat(l),avatar:e.picture||void 0,lastMessage:e.lastMessage.body||"Media mesajı",timestamp:r,unreadCount:0,sessionLabel:s.label||s.id,sessionPhone:s.phone||"",sessionId:s.id,isOnline:!1,isPinned:!1,isMuted:!1,isArchived:!1,rawChatId:e.id,lastMessageAck:e.lastMessage.ack,lastMessageId:e.lastMessage.id,lastMessageTimestamp:e.lastMessage.timestamp}});e.push(...t)}}e.sort((e,s)=>(s.lastMessageTimestamp||0)-(e.lastMessageTimestamp||0)),L(e)}catch(e){H("Konuşma verileri alınamadı")}finally{K(!1)}}else I(!1),en(e)},em=_.filter(e=>{let s=e.name.toLowerCase().includes(a.toLowerCase())||e.phone.includes(a);switch(d){case"unread":return s&&2===e.lastMessageAck&&e.lastMessageId.startsWith("false");case"pinned":return s&&e.isPinned;case"archived":return s&&e.isArchived;default:return s&&!e.isArchived}}),eh=_.find(s=>s.id===e),eu=R.filter(s=>s.contactId===e),ej=async()=>{if(o.trim()&&eh&&!q)try{await ed(eh.rawChatId,eh.sessionId,o),m("")}catch(e){console.error("Error sending message:",e)}},ef=async()=>{if(!f.trim()||!k)return;let e=A.find(e=>e.id===k);if(!e)return;let a=f.replace(/[\s\+\-\(\)]/g,""),l="".concat(a,"@c.us"),t=_.find(e=>e.rawChatId===l);if(t){s(t.id),j(!1),v(""),C("");return}let i={id:"".concat(k,"_").concat(l),name:a,phone:"+".concat(a),lastMessage:"Yeni konuşma başlatıldı",timestamp:"Şimdi",unreadCount:0,sessionLabel:e.label,sessionPhone:e.phone,sessionId:k,isOnline:!1,isPinned:!1,isMuted:!1,isArchived:!1,rawChatId:l,lastMessageAck:0,lastMessageId:"false",lastMessageTimestamp:void 0};L(e=>[i,...e]),s(i.id),j(!1),v(""),C("")},eg=e=>e.split(" ").map(e=>e[0]).join("").toUpperCase();return(0,l.jsxs)("div",{className:"flex h-full bg-gray-50",children:[(0,l.jsxs)("div",{className:"w-80 bg-white border-r border-gray-200 flex flex-col",children:[(0,l.jsxs)("div",{className:"p-4 border-b border-gray-200 flex-shrink-0 bg-white",children:[(0,l.jsxs)("div",{className:"flex items-center justify-between mb-3",children:[(0,l.jsx)("h1",{className:"text-lg font-bold text-gray-900",children:"Konuşmalar"}),(0,l.jsxs)(y.Vq,{open:h,onOpenChange:j,children:[(0,l.jsx)(y.hg,{asChild:!0,children:(0,l.jsx)(u.z,{size:"sm",className:"bg-[#075E54] hover:bg-[#064e44] text-white shadow-sm",disabled:!k,children:(0,l.jsx)(N.Z,{className:"h-4 w-4"})})}),(0,l.jsxs)(y.cZ,{className:"sm:max-w-md",children:[(0,l.jsx)(y.fK,{children:(0,l.jsxs)(y.$N,{className:"flex items-center space-x-2",children:[(0,l.jsx)(n.Z,{className:"h-5 w-5 text-[#075E54]"}),(0,l.jsx)("span",{children:"Yeni Konuşma Başlat"})]})}),(0,l.jsxs)("div",{className:"space-y-4 pt-4",children:[(0,l.jsxs)("div",{className:"space-y-2",children:[(0,l.jsx)(w._,{htmlFor:"phone",children:"Telefon Numarası"}),(0,l.jsx)(b.I,{id:"phone",placeholder:"905XXXXXXXXX",value:f,onChange:e=>v(e.target.value),className:"h-11"}),(0,l.jsx)("p",{className:"text-xs text-gray-500",children:"\xdclke kodu ile birlikte girin (\xf6rn: 905551234567)"})]}),(0,l.jsxs)("div",{className:"space-y-2",children:[(0,l.jsx)(w._,{htmlFor:"session",children:"Session Se\xe7"}),(0,l.jsxs)(ei.Ph,{value:k,onValueChange:eo,children:[(0,l.jsx)(ei.i4,{className:"w-full h-10",children:(0,l.jsx)(ei.ki,{placeholder:"Session se\xe7in"})}),(0,l.jsxs)(ei.Bw,{children:[(0,l.jsx)(ei.Ql,{value:"ALL",children:"T\xfcm Sessionlar"}),A.map(e=>(0,l.jsx)(ei.Ql,{value:e.id,children:(0,l.jsxs)("div",{className:"flex flex-col",children:[(0,l.jsx)("span",{className:"font-medium",children:e.label}),(0,l.jsxs)("span",{className:"text-sm text-gray-500",children:["+",e.phone]})]})},e.id))]})]})]}),(0,l.jsxs)("div",{className:"flex justify-end space-x-2 pt-4",children:[(0,l.jsx)(u.z,{variant:"outline",onClick:()=>j(!1),children:"İptal"}),(0,l.jsx)(u.z,{onClick:ef,disabled:!f.trim()||!k,className:"bg-[#075E54] hover:bg-[#064e44]",children:"Konuşmayı Başlat"})]})]})]})]})]}),A.length>0&&(0,l.jsx)("div",{className:"mb-3",children:(0,l.jsxs)(ei.Ph,{value:k,onValueChange:eo,children:[(0,l.jsx)(ei.i4,{className:"w-full h-10",children:(0,l.jsx)(ei.ki,{placeholder:"Session se\xe7in"})}),(0,l.jsxs)(ei.Bw,{children:[(0,l.jsx)(ei.Ql,{value:"ALL",children:"T\xfcm Sessionlar"}),A.map(e=>(0,l.jsx)(ei.Ql,{value:e.id,children:(0,l.jsxs)("div",{className:"flex items-center space-x-2",children:[(0,l.jsx)("div",{className:"w-2 h-2 bg-green-500 rounded-full"}),(0,l.jsx)("span",{children:e.label})]})},e.id))]})]})}),(0,l.jsxs)("div",{className:"relative mb-3",children:[(0,l.jsx)(V.Z,{className:"absolute left-3 top-1/2 transform -translate-y-1/2 h-4 w-4 text-gray-400"}),(0,l.jsx)(b.I,{placeholder:"Konuşmalarda ara...",value:a,onChange:e=>r(e.target.value),className:"pl-10 h-10 bg-gray-50 border-gray-200 focus:bg-white transition-colors"})]}),(0,l.jsx)("div",{className:"flex flex-wrap gap-1",children:[{key:"all",label:"T\xfcm\xfc",count:_.length},{key:"unread",label:"Okunmamış",count:_.filter(e=>2===e.lastMessageAck&&e.lastMessageId.startsWith("false")).length},{key:"pinned",label:"Sabitlenmiş",count:_.filter(e=>e.isPinned).length},{key:"archived",label:"Arşiv",count:_.filter(e=>e.isArchived).length}].map(e=>(0,l.jsxs)("button",{onClick:()=>x(e.key),className:(0,i.cn)("flex items-center space-x-1 px-2.5 py-1.5 rounded-full text-xs font-medium transition-all duration-200",d===e.key?"bg-[#075E54] text-white shadow-sm":"bg-gray-100 text-gray-600 hover:bg-gray-200"),children:[(0,l.jsx)("span",{children:e.label}),e.count>0&&(0,l.jsx)("span",{className:(0,i.cn)("text-xs px-1 py-0.5 rounded-full min-w-[16px] text-center",d===e.key?"bg-white/20 text-white":"bg-gray-300 text-gray-600"),children:e.count>99?"99+":e.count})]},e.key))})]}),P&&(0,l.jsxs)("div",{className:"flex-1 flex items-center justify-center",children:[(0,l.jsx)(g.Z,{className:"h-6 w-6 animate-spin text-gray-400"}),(0,l.jsx)("span",{className:"ml-2 text-gray-600",children:"Y\xfckleniyor..."})]}),G&&(0,l.jsx)("div",{className:"flex-1 flex items-center justify-center p-4",children:(0,l.jsxs)("div",{className:"text-center",children:[(0,l.jsx)(p.Z,{className:"h-8 w-8 text-red-500 mx-auto mb-2"}),(0,l.jsx)("p",{className:"text-sm text-gray-600",children:G}),(0,l.jsx)(u.z,{onClick:()=>k&&en(k),size:"sm",className:"mt-2",children:"Tekrar Dene"})]})}),!P&&!G&&(0,l.jsx)("div",{className:"flex-1 overflow-y-auto bg-gray-50",children:0===em.length?(0,l.jsxs)("div",{className:"p-6 text-center text-gray-500",children:[(0,l.jsx)(n.Z,{className:"h-12 w-12 text-gray-300 mx-auto mb-3"}),(0,l.jsx)("p",{className:"font-medium",children:k?"Konuşma bulunamadı":"Bir session se\xe7in"}),(0,l.jsx)("p",{className:"text-sm text-gray-400 mt-1",children:k?'Yeni bir konuşma başlatmak i\xe7in "Yeni Chat" butonunu kullanın':"Mesajlaşmaya başlamak i\xe7in yukarıdan bir session se\xe7in"})]}):(0,l.jsx)("div",{className:"divide-y divide-gray-100",children:em.map(a=>(0,l.jsx)("div",{onClick:()=>s(a.id),className:(0,i.cn)("p-4 cursor-pointer transition-all duration-200 hover:bg-white hover:shadow-sm border-l-4",e===a.id?"bg-white border-l-[#075E54] shadow-sm":"bg-transparent border-l-transparent hover:border-l-gray-200"),children:(0,l.jsxs)("div",{className:"flex items-start space-x-3",children:[(0,l.jsxs)("div",{className:"relative flex-shrink-0",children:[(0,l.jsxs)(el.qE,{className:"h-12 w-12 ring-2 ring-white shadow-sm",children:[(0,l.jsx)(el.F$,{src:a.avatar}),(0,l.jsx)(el.Q5,{className:"bg-gradient-to-br from-[#075E54] to-[#128C7E] text-white font-medium",children:eg(a.name)})]}),a.isOnline&&(0,l.jsx)("div",{className:"absolute -bottom-0.5 -right-0.5 h-4 w-4 bg-green-500 border-2 border-white rounded-full"}),a.unreadCount>0&&(0,l.jsx)("div",{className:"absolute -top-1 -right-1 h-5 w-5 bg-[#25D366] text-white text-xs font-bold rounded-full flex items-center justify-center shadow-sm",children:a.unreadCount>9?"9+":a.unreadCount})]}),(0,l.jsxs)("div",{className:"flex-1 min-w-0",children:[(0,l.jsxs)("div",{className:"flex items-center justify-between mb-1",children:[(0,l.jsxs)("div",{className:"flex items-center space-x-2 min-w-0",children:[(0,l.jsx)("h3",{className:(0,i.cn)("font-medium text-gray-900 truncate",a.unreadCount>0&&"font-semibold"),children:a.name}),(0,l.jsxs)("div",{className:"flex items-center space-x-1",children:[a.isPinned&&(0,l.jsx)($.Z,{className:"h-3 w-3 text-gray-400 fill-current"}),a.isMuted&&(0,l.jsx)(X.Z,{className:"h-3 w-3 text-gray-400"})]})]}),(0,l.jsx)("span",{className:"text-xs text-gray-500 flex-shrink-0 ml-2",children:a.timestamp})]}),(0,l.jsx)("p",{className:(0,i.cn)("text-sm text-gray-600 truncate mb-2",a.unreadCount>0&&"font-medium text-gray-800"),children:a.lastMessage}),(0,l.jsxs)("div",{className:"flex items-center justify-between",children:[(0,l.jsx)(z.C,{variant:"outline",className:"text-xs bg-gray-50 text-gray-600 border-gray-200 font-normal",children:a.sessionLabel}),a.unreadCount>0&&(0,l.jsx)("div",{className:"w-2 h-2 bg-[#25D366] rounded-full"})]})]})]})},a.id))})})]}),(0,l.jsx)("div",{className:"flex-1 flex flex-col min-w-0",children:eh?(0,l.jsxs)(l.Fragment,{children:[(0,l.jsx)("div",{className:"bg-white border-b border-gray-200 p-4 flex-shrink-0 shadow-sm",children:(0,l.jsxs)("div",{className:"flex items-center justify-between",children:[(0,l.jsxs)("div",{className:"flex items-center space-x-3",children:[(0,l.jsxs)(el.qE,{className:"h-10 w-10 ring-2 ring-gray-100",children:[(0,l.jsx)(el.F$,{src:eh.avatar}),(0,l.jsx)(el.Q5,{className:"bg-gradient-to-br from-[#075E54] to-[#128C7E] text-white font-medium",children:eg(eh.name)})]}),(0,l.jsxs)("div",{children:[(0,l.jsx)("h2",{className:"font-semibold text-gray-900",children:eh.name}),(0,l.jsxs)("div",{className:"flex items-center space-x-2 text-sm text-gray-500",children:[(0,l.jsx)("span",{children:eh.phone}),(0,l.jsx)("span",{children:"•"}),(0,l.jsxs)("span",{className:"text-[#075E54] font-medium",children:["via ",eh.sessionLabel]}),eh.isOnline&&(0,l.jsxs)(l.Fragment,{children:[(0,l.jsx)("span",{children:"•"}),(0,l.jsxs)("div",{className:"flex items-center space-x-1",children:[(0,l.jsx)("div",{className:"w-2 h-2 bg-green-500 rounded-full"}),(0,l.jsx)("span",{className:"text-green-600 font-medium",children:"\xc7evrimi\xe7i"})]})]})]})]})]}),(0,l.jsxs)("div",{className:"flex items-center space-x-2",children:[(0,l.jsx)(u.z,{variant:"outline",size:"sm",onClick:()=>{eh&&ec(eh.sessionId,eh.rawChatId,eh.id)},disabled:F,className:"hover:bg-gray-50",children:F?(0,l.jsx)(g.Z,{className:"h-4 w-4 animate-spin"}):(0,l.jsx)(g.Z,{className:"h-4 w-4"})}),(0,l.jsxs)(T,{children:[(0,l.jsx)(O,{asChild:!0,children:(0,l.jsx)(u.z,{variant:"outline",size:"sm",className:"hover:bg-gray-50",children:(0,l.jsx)(W.Z,{className:"h-4 w-4"})})}),(0,l.jsxs)(D,{align:"end",className:"w-48",children:[(0,l.jsxs)(B,{className:"flex items-center space-x-2",children:[(0,l.jsx)($.Z,{className:"h-4 w-4"}),(0,l.jsx)("span",{children:eh.isPinned?"Sabitlemeyi Kaldır":"Sabitle"})]}),(0,l.jsxs)(B,{className:"flex items-center space-x-2",children:[eh.isMuted?(0,l.jsx)(J.Z,{className:"h-4 w-4"}):(0,l.jsx)(X.Z,{className:"h-4 w-4"}),(0,l.jsx)("span",{children:eh.isMuted?"Sesi A\xe7":"Sessize Al"})]}),(0,l.jsxs)(B,{className:"flex items-center space-x-2",children:[(0,l.jsx)(ee.Z,{className:"h-4 w-4"}),(0,l.jsx)("span",{children:"Arşivle"})]})]})]})]})]})}),(0,l.jsx)("div",{className:"flex-1 overflow-y-auto p-4 space-y-4 bg-gradient-to-b from-gray-50 to-white",children:F?(0,l.jsx)("div",{className:"flex justify-center py-8",children:(0,l.jsxs)("div",{className:"flex items-center space-x-3 text-gray-500",children:[(0,l.jsx)(g.Z,{className:"h-5 w-5 animate-spin"}),(0,l.jsx)("span",{className:"font-medium",children:"Mesajlar y\xfckleniyor..."})]})}):0===eu.length?(0,l.jsxs)("div",{className:"text-center py-12",children:[(0,l.jsx)("div",{className:"bg-white rounded-full p-6 w-20 h-20 mx-auto mb-4 shadow-sm",children:(0,l.jsx)(n.Z,{className:"h-8 w-8 text-gray-400 mx-auto"})}),(0,l.jsx)("h3",{className:"font-medium text-gray-900 mb-2",children:"Hen\xfcz mesaj yok"}),(0,l.jsx)("p",{className:"text-gray-500",children:"İlk mesajı g\xf6ndererek konuşmayı başlatın!"})]}):eu.map(e=>(0,l.jsx)("div",{className:(0,i.cn)("flex",e.isOutgoing?"justify-end":"justify-start"),children:(0,l.jsxs)("div",{className:(0,i.cn)("max-w-xs lg:max-w-md px-4 py-3 rounded-2xl shadow-sm relative",e.isOutgoing?"bg-[#075E54] text-white rounded-br-md":"bg-white border border-gray-200 text-gray-900 rounded-bl-md"),children:[(0,l.jsx)("p",{className:"text-sm leading-relaxed",children:e.content}),(0,l.jsxs)("div",{className:(0,i.cn)("flex items-center justify-end space-x-1 mt-2 text-xs",e.isOutgoing?"text-green-100":"text-gray-500"),children:[(0,l.jsx)("span",{className:"font-medium",children:e.timestamp}),e.isOutgoing&&(0,l.jsxs)("div",{className:"flex ml-1",children:["sent"===e.status&&(0,l.jsx)(S.Z,{className:"h-3 w-3"}),"delivered"===e.status&&(0,l.jsxs)("div",{className:"flex",children:[(0,l.jsx)("div",{className:"h-3 w-3 border border-current rounded-full mr-0.5 opacity-70"}),(0,l.jsx)("div",{className:"h-3 w-3 border border-current rounded-full"})]}),"read"===e.status&&(0,l.jsxs)("div",{className:"flex text-blue-300",children:[(0,l.jsx)("div",{className:"h-3 w-3 bg-current rounded-full mr-0.5"}),(0,l.jsx)("div",{className:"h-3 w-3 bg-current rounded-full"})]})]})]})]})},e.id))}),(0,l.jsx)("div",{className:"bg-white border-t border-gray-200 p-4 flex-shrink-0",children:(0,l.jsxs)("div",{className:"flex items-end space-x-3",children:[(0,l.jsx)(u.z,{variant:"outline",size:"sm",className:"flex-shrink-0 h-11 w-11 rounded-full hover:bg-gray-50",children:(0,l.jsx)(es.Z,{className:"h-4 w-4"})}),(0,l.jsxs)("div",{className:"flex-1 relative",children:[(0,l.jsx)(et,{placeholder:"Mesaj yazın...",value:o,onChange:e=>m(e.target.value),onKeyPress:e=>{"Enter"!==e.key||e.shiftKey||(e.preventDefault(),ej())},className:"min-h-[44px] max-h-32 resize-none rounded-2xl border-gray-200 focus:border-[#075E54] focus:ring-[#075E54] pr-12",disabled:q}),(0,l.jsx)(u.z,{variant:"ghost",size:"sm",className:"absolute right-2 top-1/2 transform -translate-y-1/2 h-8 w-8 rounded-full hover:bg-gray-100",children:(0,l.jsx)(ea.Z,{className:"h-4 w-4"})})]}),(0,l.jsx)(u.z,{onClick:ej,disabled:!o.trim()||q,className:"flex-shrink-0 h-11 w-11 rounded-full bg-[#075E54] hover:bg-[#064e44] shadow-lg disabled:opacity-50 disabled:cursor-not-allowed",children:q?(0,l.jsx)(g.Z,{className:"h-4 w-4 animate-spin"}):(0,l.jsx)(c.Z,{className:"h-4 w-4"})})]})})]}):(0,l.jsx)("div",{className:"flex-1 flex items-center justify-center bg-gradient-to-br from-gray-50 to-white",children:(0,l.jsxs)("div",{className:"text-center max-w-md",children:[(0,l.jsx)("div",{className:"bg-white rounded-full p-8 w-24 h-24 mx-auto mb-6 shadow-lg",children:(0,l.jsx)(n.Z,{className:"h-8 w-8 text-[#075E54] mx-auto"})}),(0,l.jsx)("h3",{className:"text-xl font-semibold text-gray-900 mb-3",children:"WhatsApp Web benzeri deneyim"}),(0,l.jsx)("p",{className:"text-gray-600 mb-6 leading-relaxed",children:"Sol taraftan bir konuşma se\xe7erek mesajlaşmaya başlayın. Yeni konuşmalar başlatabilir, mevcut konuşmaları y\xf6netebilir ve ger\xe7ek zamanlı mesajlaşabilirsiniz."}),(0,l.jsxs)("div",{className:"flex items-center justify-center space-x-4 text-sm text-gray-500",children:[(0,l.jsxs)("div",{className:"flex items-center space-x-2",children:[(0,l.jsx)("div",{className:"w-2 h-2 bg-green-500 rounded-full"}),(0,l.jsx)("span",{children:"Ger\xe7ek zamanlı"})]}),(0,l.jsxs)("div",{className:"flex items-center space-x-2",children:[(0,l.jsx)("div",{className:"w-2 h-2 bg-blue-500 rounded-full"}),(0,l.jsx)("span",{children:"\xc7oklu session"})]}),(0,l.jsxs)("div",{className:"flex items-center space-x-2",children:[(0,l.jsx)("div",{className:"w-2 h-2 bg-purple-500 rounded-full"}),(0,l.jsx)("span",{children:"G\xfcvenli"})]})]})]})})})]})}var en=a(4900),ec=a(5750),ed=a(2369),ex=a(4056),eo=a(3700);let em=t.forwardRef((e,s)=>{let{className:a,...t}=e;return(0,l.jsx)(eo.fC,{ref:s,className:(0,i.cn)("peer h-4 w-4 shrink-0 rounded-sm border border-primary ring-offset-background focus-visible:outline-none focus-visible:ring-2 focus-visible:ring-ring focus-visible:ring-offset-2 disabled:cursor-not-allowed disabled:opacity-50 data-[state=checked]:bg-primary data-[state=checked]:text-primary-foreground",a),...t,children:(0,l.jsx)(eo.z$,{className:(0,i.cn)("flex items-center justify-center text-current"),children:(0,l.jsx)(M.Z,{className:"h-4 w-4"})})})});em.displayName=eo.fC.displayName;let eh=t.forwardRef((e,s)=>{let{className:a,value:t=0,...r}=e;return(0,l.jsxs)("div",{ref:s,className:(0,i.cn)("relative h-3 w-full overflow-hidden rounded-full bg-gray-200 shadow-inner",a),...r,children:[(0,l.jsx)("div",{className:"h-full bg-gradient-to-r from-[#075E54] via-[#128C7E] to-[#25D366] transition-all duration-700 ease-out relative overflow-hidden rounded-full shadow-sm",style:{width:"".concat(Math.max(0,Math.min(100,t)),"%")},children:(0,l.jsx)("div",{className:"absolute inset-0 bg-gradient-to-r from-transparent via-white/40 to-transparent",style:{animation:t>0?"shine 2s ease-in-out infinite":"none",backgroundSize:"200% 100%"}})}),0===t&&(0,l.jsx)("div",{className:"absolute inset-0 bg-gradient-to-r from-gray-300 via-gray-400 to-gray-300 animate-pulse rounded-full"})]})});eh.displayName="Progress";var eu=a(3607);let ej=t.forwardRef((e,s)=>{let{className:a,orientation:t="horizontal",decorative:r=!0,...n}=e;return(0,l.jsx)(eu.f,{ref:s,decorative:r,orientation:t,className:(0,i.cn)("shrink-0 bg-border","horizontal"===t?"h-[1px] w-full":"h-full w-[1px]",a),...n})});function ef(){let[e,s]=(0,t.useState)(""),[a,i]=(0,t.useState)(""),[r,d]=(0,t.useState)([]),[x,m]=(0,t.useState)([]),[h,j]=(0,t.useState)(!0),[f,N]=(0,t.useState)(!1),[y,k]=(0,t.useState)(null),[E,I]=(0,t.useState)(!1),[A,M]=(0,t.useState)(!1),[_,T]=(0,t.useState)(1),O=()=>e.split("\n").filter(e=>e.trim().length>0).length,L=async()=>{try{j(!0);let e=await (0,Z.ax)("/sessions");if(!e.ok)throw Error("Session verileri alınamadı");let s=await e.json(),a=s.filter(e=>e.me&&e.me.id&&"WORKING"===e.status).map((e,s)=>({id:e.name,name:e.name,label:e.me.pushName||"Session ".concat(s+1),phone:e.me.id.replace("@c.us",""),status:e.status}));d(a)}catch(e){console.error("Error fetching sessions:",e)}finally{j(!1)}};(0,t.useEffect)(()=>{L()},[]);let R=e=>{m(s=>s.includes(e)?s.filter(s=>s!==e):[...s,e])},D=async()=>{if(!a.trim()){alert("L\xfctfen mesaj i\xe7eriğini girin");return}let s=O();if(0===s){alert("L\xfctfen en az bir kişi ekleyin");return}if(0===x.length){alert("L\xfctfen en az bir session se\xe7in");return}N(!0),k(null);try{let s=await (0,Z.ax)("/send-text-multiple",{method:"POST",body:JSON.stringify({phone_list_text:e,reply_to:null,text:a,linkPreview:!0,linkPreviewHighQuality:!1,sessions:x,is_rotation_enabled:E?"true":"false",is_ai_enabled:A?"true":"false"})}),l=await s.json().catch(()=>({}));k({ok:s.ok,data:l}),s.ok||alert(l.message||"Toplu mesaj g\xf6nderilemedi")}catch(e){k({ok:!1,data:{message:"Bağlantı hatası"}}),alert("Bağlantı hatası")}finally{N(!1)}};return(0,l.jsxs)("div",{className:"p-6 max-w-7xl mx-auto",children:[(0,l.jsx)("div",{className:"mb-8",children:(0,l.jsxs)("div",{className:"flex items-center justify-between",children:[(0,l.jsxs)("div",{children:[(0,l.jsx)("h1",{className:"text-3xl font-bold text-gray-900 mb-2",children:"Toplu Mesaj G\xf6nderimi"}),(0,l.jsx)("p",{className:"text-gray-600",children:"Birden fazla kişiye aynı anda mesaj g\xf6nderin"})]}),(0,l.jsxs)("div",{className:"flex items-center space-x-3",children:[(0,l.jsxs)(u.z,{onClick:L,variant:"outline",size:"sm",disabled:h,children:[h?(0,l.jsx)(g.Z,{className:"h-4 w-4 animate-spin mr-2"}):(0,l.jsx)(g.Z,{className:"h-4 w-4 mr-2"}),"Yenile"]}),f&&(0,l.jsxs)("div",{className:"flex items-center space-x-2",children:[(0,l.jsxs)(u.z,{onClick:()=>{},variant:"outline",size:"sm",className:"text-yellow-600 hover:text-yellow-700",children:[(0,l.jsx)(en.Z,{className:"h-4 w-4 mr-2"}),"Devam Et"]}),(0,l.jsxs)(u.z,{onClick:()=>{},variant:"outline",size:"sm",className:"text-red-600 hover:text-red-700",children:[(0,l.jsx)(o.Z,{className:"h-4 w-4 mr-2"}),"Durdur"]})]})]})]})}),(0,l.jsxs)("div",{className:"grid grid-cols-1 xl:grid-cols-3 gap-6",children:[(0,l.jsxs)("div",{className:"xl:col-span-2 space-y-6",children:[(0,l.jsxs)(v.Zb,{children:[(0,l.jsxs)(v.Ol,{children:[(0,l.jsxs)("div",{className:"flex items-center justify-between",children:[(0,l.jsxs)("div",{className:"flex items-center space-x-2",children:[(0,l.jsx)(ec.Z,{className:"h-5 w-5 text-[#075E54]"}),(0,l.jsx)(v.ll,{children:"Telefon Listesi"})]}),(0,l.jsxs)(z.C,{variant:"outline",className:"text-sm",children:[O()," kişi"]})]}),(0,l.jsxs)(v.SZ,{children:["Her satıra bir kişi ekleyin: ",(0,l.jsx)("br",{}),(0,l.jsx)("span",{className:"font-mono text-xs",children:"+905551234567\\temrullah\\ttilki"})," ",(0,l.jsx)("br",{}),"(Numara, ad, soyad tab ile ayrılmış)"]})]}),(0,l.jsx)(v.aY,{children:(0,l.jsx)(et,{placeholder:"+905551234567	emrullah	tilki\n+905551234568	sinan	\xe7elikiz",value:e,onChange:e=>s(e.target.value),className:"min-h-[180px] font-mono text-sm"})})]}),(0,l.jsxs)(v.Zb,{children:[(0,l.jsxs)(v.Ol,{children:[(0,l.jsxs)("div",{className:"flex items-center justify-between",children:[(0,l.jsxs)("div",{className:"flex items-center space-x-2",children:[(0,l.jsx)(n.Z,{className:"h-5 w-5 text-[#075E54]"}),(0,l.jsx)(v.ll,{children:"Mesaj İ\xe7eriği"})]}),(0,l.jsxs)(z.C,{variant:"outline",className:"text-sm",children:[a.length," karakter"]})]}),(0,l.jsx)(v.SZ,{children:"G\xf6nderilecek mesajın i\xe7eriğini yazın"})]}),(0,l.jsx)(v.aY,{children:(0,l.jsx)(et,{placeholder:"Mesajınızı buraya yazın...",value:a,onChange:e=>i(e.target.value),className:"min-h-[120px]"})})]}),(0,l.jsxs)(v.Zb,{children:[(0,l.jsx)(v.Ol,{children:(0,l.jsx)(v.ll,{children:"G\xf6nderim Ayarları"})}),(0,l.jsxs)(v.aY,{className:"space-y-6",children:[(0,l.jsxs)("div",{className:"space-y-3",children:[(0,l.jsxs)("div",{className:"flex items-center space-x-2",children:[(0,l.jsx)(S.Z,{className:"h-4 w-4 text-gray-600"}),(0,l.jsx)(w._,{className:"font-medium",children:"Mesaj Arası Bekleme S\xfcresi"})]}),(0,l.jsxs)("div",{className:"flex items-center space-x-4",children:[(0,l.jsx)("div",{className:"flex-1",children:(0,l.jsxs)(ei.Ph,{value:_.toString(),onValueChange:e=>T(Number(e)),children:[(0,l.jsx)(ei.i4,{children:(0,l.jsx)(ei.ki,{})}),(0,l.jsxs)(ei.Bw,{children:[(0,l.jsx)(ei.Ql,{value:"1",children:"1 saniye"}),(0,l.jsx)(ei.Ql,{value:"2",children:"2 saniye"}),(0,l.jsx)(ei.Ql,{value:"3",children:"3 saniye"}),(0,l.jsx)(ei.Ql,{value:"5",children:"5 saniye"}),(0,l.jsx)(ei.Ql,{value:"10",children:"10 saniye"}),(0,l.jsx)(ei.Ql,{value:"30",children:"30 saniye"}),(0,l.jsx)(ei.Ql,{value:"60",children:"1 dakika"})]})]})}),(0,l.jsx)("div",{className:"text-sm text-gray-600",children:"veya"}),(0,l.jsx)("div",{className:"w-24",children:(0,l.jsx)(b.I,{type:"number",min:"1",max:"300",value:_,onChange:e=>T(Math.max(1,Math.min(300,Number(e.target.value)||1))),className:"text-center"})}),(0,l.jsx)("span",{className:"text-sm text-gray-600",children:"saniye"})]}),(0,l.jsx)("p",{className:"text-sm text-gray-600",children:"Spam tespitini \xf6nlemek i\xe7in mesajlar arasında bekleme s\xfcresi"})]}),(0,l.jsx)(ej,{}),(0,l.jsxs)("div",{className:"space-y-4",children:[(0,l.jsxs)("div",{className:"flex items-center space-x-2",children:[(0,l.jsx)(em,{id:"rotation",checked:E,onCheckedChange:e=>{I(e)}}),(0,l.jsxs)("div",{className:"flex items-center space-x-2",children:[(0,l.jsx)(H.Z,{className:"h-4 w-4 text-gray-600"}),(0,l.jsx)(w._,{htmlFor:"rotation",className:"font-medium",children:"Rotasyon"})]})]}),(0,l.jsx)("p",{className:"text-sm text-gray-600 ml-6",children:"Mesajları farklı session'lar arasında d\xf6ng\xfcsel olarak g\xf6nder"})]}),(0,l.jsxs)("div",{className:"flex items-center space-x-2",children:[(0,l.jsx)(em,{id:"ai",checked:A,onCheckedChange:e=>M(e)}),(0,l.jsxs)("div",{className:"flex items-center space-x-2",children:[(0,l.jsx)(ed.Z,{className:"h-4 w-4 text-yellow-500"}),(0,l.jsx)(w._,{htmlFor:"ai",className:"font-medium",children:"AI \xd6zg\xfcnleştirici"})]})]}),(0,l.jsx)("p",{className:"text-sm text-gray-600 ml-6",children:"Her mesajı AI ile hafif\xe7e farklılaştır"}),A&&(0,l.jsxs)("div",{className:"mt-3 p-3 bg-yellow-50 border border-yellow-200 rounded-lg",children:[(0,l.jsxs)("div",{className:"flex items-center space-x-2 text-yellow-800",children:[(0,l.jsx)(ed.Z,{className:"h-4 w-4"}),(0,l.jsx)("span",{className:"text-sm font-medium",children:"AI \xd6zg\xfcnleştirici Aktif"})]}),(0,l.jsx)("p",{className:"text-sm text-yellow-700 mt-1",children:"Her mesaj farklı selamlamalar ile \xf6zelleştirilecek"})]})]})]}),h?(0,l.jsxs)("div",{className:"flex items-center justify-center py-8",children:[(0,l.jsx)(g.Z,{className:"h-6 w-6 animate-spin text-gray-400"}),(0,l.jsx)("span",{className:"ml-2 text-gray-600",children:"Session'lar y\xfckleniyor..."})]}):0===r.length?(0,l.jsxs)("div",{className:"text-center py-8 text-gray-500",children:[(0,l.jsx)(p.Z,{className:"h-8 w-8 mx-auto mb-2"}),(0,l.jsx)("p",{children:"Aktif session bulunamadı"}),(0,l.jsx)("p",{className:"text-sm mt-1",children:"Session Manager'dan yeni session ekleyin"})]}):(0,l.jsxs)(v.Zb,{children:[(0,l.jsx)(v.Ol,{children:(0,l.jsxs)("div",{className:"flex items-center justify-between",children:[(0,l.jsxs)("div",{children:[(0,l.jsx)(v.ll,{children:"Session Se\xe7imi"}),(0,l.jsx)(v.SZ,{children:"Mesajları g\xf6ndermek i\xe7in kullanılacak session'ı se\xe7in"})]}),r.length>0&&(0,l.jsx)(u.z,{variant:"outline",size:"sm",onClick:()=>{x.length===r.length?m([]):m(r.map(e=>e.id))},children:x.length===r.length?"T\xfcm\xfcn\xfc Kaldır":"T\xfcm\xfcn\xfc Se\xe7"})]})}),(0,l.jsx)(v.aY,{children:(0,l.jsx)("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-3",children:r.map(e=>(0,l.jsxs)("div",{className:"flex items-center space-x-3 p-3 border rounded-lg hover:bg-gray-50 transition-colors",children:[(0,l.jsx)(em,{id:e.id,checked:x.includes(e.id),onCheckedChange:()=>R(e.id)}),(0,l.jsxs)("div",{className:"flex-1",children:[(0,l.jsxs)("div",{className:"flex items-center space-x-2",children:[(0,l.jsx)(w._,{htmlFor:e.id,className:"font-medium cursor-pointer",children:e.label}),(0,l.jsxs)(z.C,{variant:"outline",className:"text-xs",children:["+",e.phone]})]}),(0,l.jsx)("p",{className:"text-sm text-gray-600",children:e.name})]})]},e.id))})})]}),(0,l.jsx)(v.Zb,{children:(0,l.jsx)(v.aY,{className:"pt-6",children:(0,l.jsx)(u.z,{onClick:D,disabled:f||!a.trim()||0===O()||0===x.length,className:"w-full h-14 bg-[#075E54] hover:bg-[#064e44] text-white font-medium text-lg",size:"lg",children:f?(0,l.jsxs)("div",{className:"flex items-center space-x-3",children:[(0,l.jsx)(g.Z,{className:"h-5 w-5 animate-spin"}),(0,l.jsxs)("div",{className:"text-left",children:[(0,l.jsx)("div",{children:"G\xf6nderiliyor..."}),(0,l.jsx)("div",{className:"text-sm opacity-80"})]})]}):(0,l.jsxs)("div",{className:"flex items-center space-x-2",children:[(0,l.jsx)(c.Z,{className:"h-5 w-5"}),(0,l.jsxs)("span",{children:["Toplu Mesaj G\xf6nder (",O()," kişi)"]})]})})})})]}),(0,l.jsxs)("div",{className:"space-y-6",children:[f&&(0,l.jsx)(v.Zb,{className:"border-l-4 border-l-[#075E54]",children:(0,l.jsx)(v.aY,{className:"pt-6",children:(0,l.jsxs)("div",{className:"space-y-4",children:[(0,l.jsxs)("div",{className:"flex items-center justify-between",children:[(0,l.jsxs)("div",{className:"flex items-center space-x-2",children:[(0,l.jsx)("div",{className:"w-2 h-2 bg-[#075E54] rounded-full animate-pulse"}),(0,l.jsx)("span",{className:"text-sm font-medium text-gray-700",children:"Mesajlar g\xf6nderiliyor..."})]}),(0,l.jsx)("span",{className:"text-sm font-semibold text-[#075E54]",children:"0%"})]}),(0,l.jsx)(eh,{value:0,className:"h-2"}),(0,l.jsxs)("div",{className:"flex justify-between text-xs text-gray-500",children:[(0,l.jsx)("span",{children:"Başlatıldı"}),(0,l.jsx)("span",{children:"L\xfctfen bekleyin"})]})]})})}),y&&(0,l.jsxs)(l.Fragment,{children:[(0,l.jsxs)("div",{className:"grid grid-cols-2 gap-4 mb-4",children:[(0,l.jsx)(v.Zb,{children:(0,l.jsxs)(v.aY,{className:"pt-6",children:[(0,l.jsx)("div",{className:"text-2xl font-bold text-green-600",children:Array.isArray(y.data)?y.data.filter(e=>{var s,a;return!e.error&&(!!y.ok||(null===(a=e._data)||void 0===a?void 0:null===(s=a.Info)||void 0===s?void 0:s.IsFromMe)===!0)}).length:0}),(0,l.jsx)("p",{className:"text-sm text-gray-600",children:"Başarılı"})]})}),(0,l.jsx)(v.Zb,{children:(0,l.jsxs)(v.aY,{className:"pt-6",children:[(0,l.jsx)("div",{className:"text-2xl font-bold text-red-600",children:Array.isArray(y.data)?y.data.filter(e=>{var s,a;return!!e.error||!y.ok&&(null===(a=e._data)||void 0===a?void 0:null===(s=a.Info)||void 0===s?void 0:s.IsFromMe)===!1}).length:0}),(0,l.jsx)("p",{className:"text-sm text-gray-600",children:"Hatalı"})]})})]}),(0,l.jsxs)(v.Zb,{children:[(0,l.jsxs)(v.Ol,{children:[(0,l.jsx)(v.ll,{children:"G\xf6nderim Sonu\xe7ları"}),(0,l.jsx)(v.SZ,{children:"Son g\xf6nderim işleminin detayları"})]}),(0,l.jsx)(v.aY,{children:(0,l.jsx)("div",{className:"space-y-3 max-h-[500px] overflow-y-auto",children:Array.isArray(y.data)&&y.data.length>0?y.data.map((e,s)=>{var a,t,i,r,n,c,d,x,o,m,h,u,j,f,g;let N="";if(null===(t=e._data)||void 0===t?void 0:null===(a=t.Info)||void 0===a?void 0:a.Chat)N=e._data.Info.Chat.replace(/@.*/,"");else if(e.chatId)N=e.chatId.replace(/@.*/,"");else if(e.id){let s=e.id.match(/_(\d+)@/);N=s?s[1]:""}let v=!1;v=!e.error&&(!!y.ok||(null===(r=e._data)||void 0===r?void 0:null===(i=r.Info)||void 0===i?void 0:i.IsFromMe)===!0);let b=(null===(d=e._data)||void 0===d?void 0:null===(c=d.Message)||void 0===c?void 0:null===(n=c.extendedTextMessage)||void 0===n?void 0:n.text)||"";if(!v&&e.error)try{let s=e.error.indexOf("{");if(-1!==s){let a=e.error.slice(s),l=JSON.parse(a);(null==l?void 0:null===(g=l.request)||void 0===g?void 0:null===(f=g.body)||void 0===f?void 0:f.text)&&(b=l.request.body.text)}}catch(e){}let w="";if(null===(o=e._data)||void 0===o?void 0:null===(x=o.Info)||void 0===x?void 0:x.Timestamp)try{let s=new Date(e._data.Info.Timestamp);w=s.toLocaleString("tr-TR")}catch(e){}!v&&e.error&&console.log("G\xf6nderim hatası:",e.error);let k="";if(null===(h=e._data)||void 0===h?void 0:null===(m=h.Info)||void 0===m?void 0:m.Sender){let s=e._data.Info.Sender.match(/^(\d+)/);k=s?s[1]:""}else(null===(j=e.request)||void 0===j?void 0:null===(u=j.body)||void 0===u?void 0:u.session)&&(k=e.request.body.session);return(0,l.jsxs)("div",{className:"flex items-center space-x-3 p-3 border rounded-lg ".concat(v?"bg-green-50 border-green-200":"bg-red-50 border-red-200"),children:[(0,l.jsx)("div",{className:"flex-shrink-0",children:v?(0,l.jsx)(C.Z,{className:"h-5 w-5 text-green-600"}):(0,l.jsx)(p.Z,{className:"h-5 w-5 text-red-600"})}),(0,l.jsxs)("div",{className:"flex-1 min-w-0",children:[(0,l.jsxs)("div",{className:"flex items-center space-x-2",children:[(0,l.jsx)("p",{className:"font-medium text-sm",children:N?"+".concat(N):"-"}),k&&(0,l.jsx)(z.C,{variant:"outline",className:"text-xs ml-2",children:k})]}),(0,l.jsx)("p",{className:"text-xs text-gray-600",children:b}),(0,l.jsx)("p",{className:"text-xs text-gray-500",children:w})]})]},s)}):(0,l.jsx)("div",{className:"text-gray-500 text-sm",children:"G\xf6nderim sonucu bulunamadı."})})})]})]}),(0,l.jsxs)(v.Zb,{children:[(0,l.jsx)(v.Ol,{children:(0,l.jsxs)(v.ll,{className:"flex items-center space-x-2",children:[(0,l.jsx)(ex.Z,{className:"h-5 w-5"}),(0,l.jsx)("span",{children:"Kullanım Kılavuzu"})]})}),(0,l.jsxs)(v.aY,{className:"space-y-3 text-sm text-gray-600",children:[(0,l.jsxs)("div",{children:[(0,l.jsx)("strong",{children:"Numara Formatı:"})," Her satırda numara, ad ve soyad tab ile ayrılmış olmalı: ",(0,l.jsx)("br",{}),(0,l.jsx)("span",{className:"font-mono text-xs",children:"+905551234567\\temrullah\\ttilki"})]}),(0,l.jsxs)("div",{children:[(0,l.jsx)("strong",{children:"Rotasyon:"})," Mesajları farklı session'lar arasında d\xf6ng\xfcsel olarak g\xf6nderir"]}),(0,l.jsxs)("div",{children:[(0,l.jsx)("strong",{children:"Bekleme S\xfcresi:"})," Spam tespitini \xf6nlemek i\xe7in mesajlar arasında bekleme s\xfcresi"]})]})]})]})]})]})}ej.displayName=eu.f.displayName;var eg=a(7216),ep=a(9670),eN=a(998),ev=a(1295),ey=a(3056),eb=a(2527),ew=a(3589),ek=a(5367),eS=a(7516);function eC(){let[e,s]=(0,t.useState)(""),[a,i]=(0,t.useState)(!1),[n,c]=(0,t.useState)(!1),[d,x]=(0,t.useState)({name:"",email:"",password:""}),[o,m]=(0,t.useState)(null),[h,j]=(0,t.useState)([]),[f,g]=(0,t.useState)(!0),[p,k]=(0,t.useState)(null),[S,C]=(0,t.useState)(!1),[E,I]=(0,t.useState)(0),[A,M]=(0,t.useState)(null),_=(0,t.useRef)(null),T=async()=>{g(!0),k(null);try{let[e,s,a]=await Promise.all([(0,Z.ax)("/company/me"),(0,Z.ax)("/company/users"),(0,Z.ax)("/sessions")]);if(!e.ok)throw Error("Şirket bilgisi alınamadı");if(!s.ok)throw Error("Kullanıcı listesi alınamadı");if(!a.ok)throw Error("Session bilgisi alınamadı");let l=await e.json(),t=await s.json(),i=await a.json();m(l),j(t),I(Array.isArray(i)?i.length:0);let r=t.find(e=>"admin"===e.role);C(!!r)}catch(e){k(e.message||"Bir hata oluştu")}finally{g(!1)}};if((0,t.useEffect)(()=>{T()},[]),f)return(0,l.jsx)("div",{className:"h-full flex items-center justify-center",children:(0,l.jsx)("span",{className:"text-gray-600",children:"Y\xfckleniyor..."})});if(p)return(0,l.jsx)("div",{className:"h-full flex items-center justify-center",children:(0,l.jsx)("span",{className:"text-red-600",children:p})});if(!S)return(0,l.jsx)("div",{className:"h-full flex items-center justify-center",children:(0,l.jsx)("span",{className:"text-orange-600 font-semibold",children:"Bu sayfaya erişim yetkiniz yok."})});let O=e=>e?e.split(" ").map(e=>e[0]).join("").toUpperCase():"",L=e=>{var s,a,l;let t=null===(s=e.profile)||void 0===s?void 0:s.first_name,i=null===(a=e.profile)||void 0===a?void 0:a.last_name;return t||i?[t,i].filter(Boolean).join(" "):(null===(l=e.profile)||void 0===l?void 0:l.email)||"Bilinmeyen"},R=e=>{switch(e){case"admin":return(0,l.jsx)(z.C,{className:"bg-red-100 text-red-800",children:"Y\xf6netici"});case"moderator":return(0,l.jsx)(z.C,{className:"bg-blue-100 text-blue-800",children:"Moderat\xf6r"});case"user":return(0,l.jsx)(z.C,{className:"bg-gray-100 text-gray-800",children:"Kullanıcı"});default:return(0,l.jsx)(z.C,{variant:"outline",children:e})}},D=e=>{switch(e){case"active":return(0,l.jsx)(z.C,{className:"bg-green-100 text-green-800",children:"Aktif"});case"inactive":return(0,l.jsx)(z.C,{className:"bg-gray-100 text-gray-800",children:"Pasif"});default:return(0,l.jsx)(z.C,{variant:"outline",children:e})}},B=(e,s)=>{let a="email,password\n".concat(e,",").concat(s),l=new Blob([a],{type:"text/csv"}),t=URL.createObjectURL(l);_.current&&(_.current.href=t,_.current.download="user-credentials-".concat(e,".csv"),_.current.click(),setTimeout(()=>URL.revokeObjectURL(t),1e3))},Y=async()=>{try{let e=await (0,Z.ax)("/users/create-normal",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({email:d.email,password:d.password})});if(!e.ok)throw Error("Kullanıcı oluşturulamadı");M({email:d.email,password:d.password}),i(!1),x({name:"",email:"",password:""}),c(!1),await T()}catch(e){alert("Kullanıcı oluşturulamadı!")}},P=(e,s)=>{console.log("\xc7alışan durumu değiştiriliyor:",e,"active"===s?"inactive":"active")},K=e=>{console.log("\xc7alışan siliniyor:",e)},F=h.filter(s=>{var a;return L(s).toLowerCase().includes(e.toLowerCase())||((null===(a=s.profile)||void 0===a?void 0:a.email)||"").toLowerCase().includes(e.toLowerCase())||(s.department||"").toLowerCase().includes(e.toLowerCase())});return(0,l.jsx)("div",{className:"h-full overflow-y-auto",children:(0,l.jsxs)("div",{className:"p-8",children:[(0,l.jsx)("div",{className:"mb-8",children:(0,l.jsxs)("div",{className:"flex items-center justify-between",children:[(0,l.jsxs)("div",{children:[(0,l.jsx)("h1",{className:"text-3xl font-bold text-gray-900 mb-2",children:"\xc7alışan Y\xf6netimi"}),(0,l.jsx)("p",{className:"text-gray-600",children:"Firma \xe7alışanlarını y\xf6netin ve yetkilendirin"})]}),(0,l.jsxs)(y.Vq,{open:a,onOpenChange:e=>{i(e),e||(x({name:"",email:"",password:""}),c(!1))},children:[(0,l.jsx)(y.hg,{asChild:!0,children:(0,l.jsxs)(u.z,{className:"bg-[#075E54] hover:bg-[#064e44]",children:[(0,l.jsx)(N.Z,{className:"h-4 w-4 mr-2"}),"Yeni \xc7alışan Ekle"]})}),(0,l.jsxs)(y.cZ,{className:"sm:max-w-md",children:[(0,l.jsx)(y.fK,{children:(0,l.jsx)(y.$N,{children:"Yeni \xc7alışan Ekle"})}),(0,l.jsxs)("div",{className:"space-y-4 pt-4",children:[(0,l.jsxs)("div",{className:"space-y-2",children:[(0,l.jsx)(w._,{htmlFor:"name",children:"Ad Soyad"}),(0,l.jsx)(b.I,{id:"name",placeholder:"\xc7alışanın adı soyadı",value:d.name,onChange:e=>x({...d,name:e.target.value})})]}),(0,l.jsxs)("div",{className:"space-y-2",children:[(0,l.jsx)(w._,{htmlFor:"email",children:"Email"}),(0,l.jsx)(b.I,{id:"email",type:"email",placeholder:"email@company.com",value:d.email,onChange:e=>x({...d,email:e.target.value})})]}),(0,l.jsxs)("div",{className:"space-y-2",children:[(0,l.jsx)(w._,{htmlFor:"password",children:"Şifre"}),(0,l.jsxs)("div",{className:"relative",children:[(0,l.jsx)(b.I,{id:"password",type:n?"text":"password",placeholder:"\xc7alışanın şifresi",value:d.password,onChange:e=>x({...d,password:e.target.value}),className:"pr-10"}),(0,l.jsx)("button",{type:"button",onClick:()=>c(!n),className:"absolute right-3 top-1/2 transform -translate-y-1/2 text-gray-400 hover:text-gray-600",children:n?(0,l.jsx)(eg.Z,{className:"h-4 w-4"}):(0,l.jsx)(ep.Z,{className:"h-4 w-4"})})]})]}),(0,l.jsxs)("div",{className:"flex justify-end space-x-2 pt-4",children:[(0,l.jsx)(u.z,{variant:"outline",onClick:()=>{i(!1),x({name:"",email:"",password:""}),c(!1)},children:"İptal"}),(0,l.jsx)(u.z,{onClick:Y,disabled:!d.name||!d.email||!d.password,className:"bg-[#075E54] hover:bg-[#064e44]",children:"\xc7alışan Ekle"})]})]}),A&&(0,l.jsxs)("div",{className:"my-4 flex items-center space-x-2",children:[(0,l.jsx)(u.z,{onClick:()=>B(A.email,A.password),className:"bg-green-600 hover:bg-green-700 text-white",children:"Kullanıcı Bilgilerini CSV Olarak İndir"}),(0,l.jsx)("a",{ref:_,style:{display:"none"}}),(0,l.jsx)("span",{className:"text-xs text-gray-500",children:"(Bu dosya sadece bir kereye mahsus indirilebilir!)"})]})]})]})]})}),(0,l.jsx)("div",{className:"mb-6",children:(0,l.jsxs)("div",{className:"relative max-w-md",children:[(0,l.jsx)(V.Z,{className:"absolute left-3 top-1/2 transform -translate-y-1/2 h-4 w-4 text-gray-400"}),(0,l.jsx)(b.I,{placeholder:"\xc7alışanlarda ara...",value:e,onChange:e=>s(e.target.value),className:"pl-10"})]})}),(0,l.jsxs)("div",{className:"grid grid-cols-1 md:grid-cols-2 lg:grid-cols-3 gap-6 mb-8",children:[(0,l.jsx)(v.Zb,{children:(0,l.jsx)(v.aY,{className:"pt-6",children:(0,l.jsxs)("div",{className:"flex items-center",children:[(0,l.jsx)(ec.Z,{className:"h-8 w-8 text-[#075E54] mr-3"}),(0,l.jsxs)("div",{children:[(0,l.jsx)("div",{className:"text-2xl font-bold text-gray-900",children:h.length}),(0,l.jsx)("p",{className:"text-sm text-gray-600",children:"Toplam \xc7alışan"})]})]})})}),(0,l.jsx)(v.Zb,{children:(0,l.jsx)(v.aY,{className:"pt-6",children:(0,l.jsxs)("div",{className:"flex items-center",children:[(0,l.jsx)(r.Z,{className:"h-8 w-8 text-purple-600 mr-3"}),(0,l.jsxs)("div",{children:[(0,l.jsx)("div",{className:"text-2xl font-bold text-gray-900",children:(null==o?void 0:o.session_limit)||(null==o?void 0:o.sessionLimit)||0}),(0,l.jsx)("p",{className:"text-sm text-gray-600",children:"Session Limiti"})]})]})})}),(0,l.jsx)(v.Zb,{children:(0,l.jsx)(v.aY,{className:"pt-6",children:(0,l.jsxs)("div",{className:"flex items-center",children:[(0,l.jsx)(eN.Z,{className:"h-8 w-8 text-orange-600 mr-3"}),(0,l.jsxs)("div",{children:[(0,l.jsx)("div",{className:"text-2xl font-bold text-gray-900",children:E}),(0,l.jsx)("p",{className:"text-sm text-gray-600",children:"Toplam Session"})]})]})})})]}),(0,l.jsxs)(v.Zb,{children:[(0,l.jsxs)(v.Ol,{children:[(0,l.jsx)(v.ll,{children:"\xc7alışan Listesi"}),(0,l.jsx)(v.SZ,{children:"T\xfcm firma \xe7alışanlarının listesi ve y\xf6netim se\xe7enekleri"})]}),(0,l.jsxs)(v.aY,{children:[(0,l.jsx)("div",{className:"space-y-4",children:F.map(e=>{var s;return(0,l.jsxs)("div",{className:"flex items-center space-x-4 p-4 border rounded-lg hover:bg-gray-50 transition-colors",children:[(0,l.jsxs)(el.qE,{className:"h-12 w-12",children:[(0,l.jsx)(el.F$,{src:e.avatar||void 0}),(0,l.jsx)(el.Q5,{className:"bg-[#075E54] text-white",children:O(L(e))})]}),(0,l.jsxs)("div",{className:"flex-1 min-w-0",children:[(0,l.jsxs)("div",{className:"flex items-center justify-between mb-1",children:[(0,l.jsx)("h3",{className:"font-medium text-gray-900",children:L(e)}),(0,l.jsxs)("div",{className:"flex items-center space-x-2",children:[R(e.role),D(e.status)]})]}),(0,l.jsxs)("div",{className:"flex items-center space-x-4 mb-2",children:[(0,l.jsxs)("div",{className:"flex items-center space-x-1 text-sm text-gray-600",children:[(0,l.jsx)(ev.Z,{className:"h-4 w-4"}),(0,l.jsx)("span",{children:null===(s=e.profile)||void 0===s?void 0:s.email})]}),(0,l.jsx)("div",{className:"text-sm text-gray-600",children:(0,l.jsx)("span",{children:e.department})})]}),(0,l.jsxs)("div",{className:"flex items-center space-x-4 text-xs text-gray-500",children:[(0,l.jsxs)("span",{children:["Son giriş: ",e.lastLogin]}),(0,l.jsx)("span",{children:"•"}),(0,l.jsxs)("span",{children:["Katılım: ",e.joinDate]})]})]}),(0,l.jsxs)("div",{className:"flex items-center space-x-2",children:[(0,l.jsx)(u.z,{variant:"outline",size:"sm",onClick:()=>P(e.id,e.status),className:"active"===e.status?"text-orange-600 hover:text-orange-700":"text-green-600 hover:text-green-700",children:"active"===e.status?(0,l.jsx)(ey.Z,{className:"h-4 w-4"}):(0,l.jsx)(eb.Z,{className:"h-4 w-4"})}),(0,l.jsx)(u.z,{variant:"outline",size:"sm",children:(0,l.jsx)(ew.Z,{className:"h-4 w-4"})}),(0,l.jsxs)(eS.aR,{children:[(0,l.jsx)(eS.vW,{asChild:!0,children:(0,l.jsx)(u.z,{variant:"outline",size:"sm",className:"text-red-600 hover:text-red-700",children:(0,l.jsx)(ek.Z,{className:"h-4 w-4"})})}),(0,l.jsxs)(eS._T,{children:[(0,l.jsxs)(eS.fY,{children:[(0,l.jsx)(eS.f$,{children:"\xc7alışanı Sil"}),(0,l.jsxs)(eS.yT,{children:[L(e)," adlı \xe7alışanı sistemden kalıcı olarak silmek istediğinizden emin misiniz? Bu işlem geri alınamaz."]})]}),(0,l.jsxs)(eS.xo,{children:[(0,l.jsx)(eS.le,{children:"İptal"}),(0,l.jsx)(eS.OL,{onClick:()=>K(e.id),className:"bg-red-600 hover:bg-red-700",children:"Sil"})]})]})]})]})]},e.id)})}),0===F.length&&(0,l.jsxs)("div",{className:"text-center py-12",children:[(0,l.jsx)(ec.Z,{className:"h-16 w-16 text-gray-400 mx-auto mb-4"}),(0,l.jsx)("h3",{className:"text-lg font-medium text-gray-900 mb-2",children:"\xc7alışan bulunamadı"}),(0,l.jsx)("p",{className:"text-gray-600",children:"Arama kriterlerinizi değiştirin veya yeni \xe7alışan ekleyin"})]})]})]})]})})}function eZ(e){let{user:s,onLogout:a}=e;return(0,l.jsx)("div",{className:"h-full overflow-y-auto",children:(0,l.jsxs)("div",{className:"p-8 max-w-4xl",children:[(0,l.jsx)("div",{className:"mb-8",children:(0,l.jsxs)("div",{className:"flex items-center justify-between mb-4",children:[(0,l.jsxs)("div",{children:[(0,l.jsx)("h1",{className:"text-3xl font-bold text-gray-900",children:"Settings"}),(0,l.jsx)("p",{className:"text-gray-600",children:"Hesap bilgilerinizi g\xf6r\xfcnt\xfcleyin ve y\xf6netin"})]}),(0,l.jsxs)("div",{className:"flex items-center space-x-4",children:[(0,l.jsxs)("div",{className:"flex items-center space-x-2 text-sm text-gray-600",children:[(0,l.jsx)(m.Z,{className:"h-4 w-4"}),(0,l.jsxs)("span",{children:["Hoş geldin, ",null==s?void 0:s.email]})]}),(0,l.jsxs)(u.z,{variant:"outline",onClick:a,className:"text-red-600 hover:text-red-700 hover:bg-red-50",children:[(0,l.jsx)(h.Z,{className:"h-4 w-4 mr-2"}),"\xc7ıkış Yap"]})]})]})}),(0,l.jsxs)(v.Zb,{children:[(0,l.jsxs)(v.Ol,{children:[(0,l.jsxs)("div",{className:"flex items-center space-x-2",children:[(0,l.jsx)(m.Z,{className:"h-5 w-5 text-[#075E54]"}),(0,l.jsx)(v.ll,{children:"Kullanıcı Hesabı"})]}),(0,l.jsx)(v.SZ,{children:"Hesap bilgilerinizi g\xf6r\xfcnt\xfcleyin ve y\xf6netin"})]}),(0,l.jsxs)(v.aY,{className:"space-y-4",children:[(0,l.jsxs)("div",{className:"grid grid-cols-2 gap-4",children:[(0,l.jsxs)("div",{children:[(0,l.jsx)(w._,{htmlFor:"current-email",children:"Email"}),(0,l.jsx)(b.I,{id:"current-email",value:(null==s?void 0:s.email)||"",disabled:!0,className:"bg-gray-50"})]}),(0,l.jsxs)("div",{children:[(0,l.jsx)(w._,{htmlFor:"user-type",children:"Kullanıcı Tipi"}),(0,l.jsx)(b.I,{id:"user-type",value:(null==s?void 0:s.user_type)||"",disabled:!0,className:"bg-gray-50"})]})]}),(0,l.jsxs)("div",{className:"flex items-center justify-between p-4 bg-green-50 rounded-lg",children:[(0,l.jsxs)("div",{className:"flex items-center space-x-2",children:[(0,l.jsx)("div",{className:"h-2 w-2 bg-green-500 rounded-full"}),(0,l.jsx)("span",{className:"text-sm font-medium text-green-800",children:"Aktif Oturum"})]}),(0,l.jsx)(u.z,{variant:"outline",size:"sm",onClick:a,className:"text-red-600 hover:text-red-700",children:"Oturumu Kapat"})]})]})]})]})})}function eE(e){let{user:s,onLogout:a}=e,[r,n]=(0,t.useState)("sessions"),[c,d]=(0,t.useState)(!1);return(0,l.jsxs)("div",{className:"flex h-screen bg-gray-50 overflow-hidden",children:[c&&(0,l.jsx)("div",{className:"fixed inset-0 bg-black bg-opacity-50 z-40 lg:hidden",onClick:()=>d(!1)}),(0,l.jsx)("div",{className:"hidden lg:flex lg:flex-shrink-0",children:(0,l.jsx)("div",{className:"flex flex-col w-80",children:(0,l.jsx)(f,{activeTab:r,setActiveTab:n,closeSidebar:()=>d(!1),user:s,onLogout:a})})}),(0,l.jsx)("div",{className:(0,i.cn)("fixed inset-y-0 left-0 z-50 w-80 transform transition-transform duration-300 ease-in-out lg:hidden",c?"translate-x-0":"-translate-x-full"),children:(0,l.jsx)(f,{activeTab:r,setActiveTab:n,closeSidebar:()=>d(!1),user:s,onLogout:a})}),(0,l.jsxs)("div",{className:"flex-1 flex flex-col min-w-0 bg-gray-50",children:[(0,l.jsxs)("div",{className:"lg:hidden bg-white border-b border-gray-200 px-4 py-3 flex items-center justify-between",children:[(0,l.jsx)("button",{onClick:()=>d(!0),className:"p-2 rounded-md text-gray-600 hover:bg-gray-100 hover:text-gray-900",children:(0,l.jsx)("svg",{className:"h-6 w-6",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor",children:(0,l.jsx)("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M4 6h16M4 12h16M4 18h16"})})}),(0,l.jsx)("h1",{className:"text-lg font-semibold text-gray-900",children:"WhatsApp Manager"}),(0,l.jsx)("div",{className:"w-10"})," "]}),(0,l.jsx)("main",{className:"flex-1 overflow-hidden",children:(0,l.jsx)("div",{className:"h-full overflow-y-auto",children:(()=>{switch(r){case"sessions":default:return(0,l.jsx)(U,{user:s});case"conversations":return(0,l.jsx)(er,{});case"bulk-message":return(0,l.jsx)(ef,{});case"employees":return(0,l.jsx)(eC,{});case"settings":return(0,l.jsx)(eZ,{user:s,onLogout:a})}})()})})]})]})}var ez=a(5589);function eI(e){let{onLogin:s}=e,[a,i]=(0,t.useState)(""),[r,c]=(0,t.useState)(""),[d,x]=(0,t.useState)(!1),[o,m]=(0,t.useState)(!1),[h,j]=(0,t.useState)(""),f=async e=>{if(e.preventDefault(),!a.trim()||!r.trim()){j("L\xfctfen email ve şifre alanlarını doldurun");return}m(!0),j("");try{let e=(0,Z.oN)(),l=await (0,Z.M$)("".concat(e,"/login"),{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({email:a,password:r})});if(!l.ok){let e=await l.json().catch(()=>({}));throw Error(e.message||"Giriş başarısız. L\xfctfen bilgilerinizi kontrol edin.")}let t=await l.json();localStorage.setItem("access_token",t.access_token),localStorage.setItem("refresh_token",t.refresh_token),localStorage.setItem("user_id",t.user_id),localStorage.setItem("user_email",t.email),localStorage.setItem("user_type",t.user_type),s(t)}catch(e){console.error("Login error:",e),j(e instanceof Error?e.message:"Bir hata oluştu. L\xfctfen tekrar deneyin.")}finally{m(!1)}};return(0,l.jsx)("div",{className:"min-h-screen bg-gradient-to-br from-[#075E54] to-[#128C7E] flex items-center justify-center p-4",children:(0,l.jsxs)("div",{className:"w-full max-w-md",children:[(0,l.jsxs)("div",{className:"text-center mb-8",children:[(0,l.jsx)("div",{className:"bg-white rounded-full p-6 w-20 h-20 mx-auto mb-4 shadow-lg",children:(0,l.jsx)(n.Z,{className:"h-8 w-8 text-[#075E54] mx-auto"})}),(0,l.jsx)("h1",{className:"text-3xl font-bold text-white mb-2",children:"WhatsApp Manager"}),(0,l.jsx)("p",{className:"text-green-100",children:"İş s\xfcre\xe7lerinizi y\xf6netin"})]}),(0,l.jsxs)(v.Zb,{className:"shadow-2xl border-0",children:[(0,l.jsxs)(v.Ol,{className:"text-center pb-4",children:[(0,l.jsx)(v.ll,{className:"text-2xl font-bold text-gray-900",children:"Giriş Yap"}),(0,l.jsx)(v.SZ,{children:"Hesabınıza giriş yapın ve WhatsApp session'larınızı y\xf6netin"})]}),(0,l.jsx)(v.aY,{children:(0,l.jsxs)("form",{onSubmit:f,className:"space-y-6",children:[h&&(0,l.jsx)("div",{className:"bg-red-50 border border-red-200 text-red-700 px-4 py-3 rounded-md text-sm",children:h}),(0,l.jsxs)("div",{className:"space-y-2",children:[(0,l.jsx)(w._,{htmlFor:"email",className:"text-sm font-medium text-gray-700",children:"Email"}),(0,l.jsxs)("div",{className:"relative",children:[(0,l.jsx)(ev.Z,{className:"absolute left-3 top-1/2 transform -translate-y-1/2 h-4 w-4 text-gray-400"}),(0,l.jsx)(b.I,{id:"email",type:"email",placeholder:"Email adresinizi girin",value:a,onChange:e=>i(e.target.value),className:"pl-10 h-12 border-gray-300 focus:border-[#075E54] focus:ring-[#075E54]",required:!0})]})]}),(0,l.jsxs)("div",{className:"space-y-2",children:[(0,l.jsx)(w._,{htmlFor:"password",className:"text-sm font-medium text-gray-700",children:"Şifre"}),(0,l.jsxs)("div",{className:"relative",children:[(0,l.jsx)(ez.Z,{className:"absolute left-3 top-1/2 transform -translate-y-1/2 h-4 w-4 text-gray-400"}),(0,l.jsx)(b.I,{id:"password",type:d?"text":"password",placeholder:"Şifrenizi girin",value:r,onChange:e=>c(e.target.value),className:"pl-10 pr-10 h-12 border-gray-300 focus:border-[#075E54] focus:ring-[#075E54]",required:!0}),(0,l.jsx)("button",{type:"button",onClick:()=>x(!d),className:"absolute right-3 top-1/2 transform -translate-y-1/2 text-gray-400 hover:text-gray-600",children:d?(0,l.jsx)(eg.Z,{className:"h-4 w-4"}):(0,l.jsx)(ep.Z,{className:"h-4 w-4"})})]})]}),(0,l.jsxs)("div",{className:"flex items-center justify-between",children:[(0,l.jsxs)("div",{className:"flex items-center space-x-2",children:[(0,l.jsx)("input",{id:"remember",type:"checkbox",className:"h-4 w-4 text-[#075E54] focus:ring-[#075E54] border-gray-300 rounded"}),(0,l.jsx)(w._,{htmlFor:"remember",className:"text-sm text-gray-600",children:"Beni hatırla"})]}),(0,l.jsx)("button",{type:"button",className:"text-sm text-[#075E54] hover:text-[#064e44] font-medium",children:"Şifremi unuttum"})]}),(0,l.jsx)(u.z,{type:"submit",disabled:o||!a.trim()||!r.trim(),className:"w-full h-12 bg-[#075E54] hover:bg-[#064e44] text-white font-medium text-base shadow-lg transition-all duration-200 transform hover:scale-105",children:o?(0,l.jsxs)("div",{className:"flex items-center space-x-2",children:[(0,l.jsx)("div",{className:"animate-spin rounded-full h-4 w-4 border-2 border-white border-t-transparent"}),(0,l.jsx)("span",{children:"Giriş yapılıyor..."})]}):"Giriş Yap"}),(0,l.jsxs)("div",{className:"relative",children:[(0,l.jsx)("div",{className:"absolute inset-0 flex items-center",children:(0,l.jsx)("div",{className:"w-full border-t border-gray-300"})}),(0,l.jsx)("div",{className:"relative flex justify-center text-sm",children:(0,l.jsx)("span",{className:"px-2 bg-white text-gray-500",children:"veya"})})]}),(0,l.jsxs)("div",{className:"text-center",children:[(0,l.jsx)("p",{className:"text-sm text-gray-600 mb-3",children:"Demo hesap ile giriş yapın:"}),(0,l.jsxs)("div",{className:"bg-gray-50 p-3 rounded-lg text-sm",children:[(0,l.jsx)("p",{className:"font-medium text-gray-700",children:"Email: admin2@gmail.com"}),(0,l.jsx)("p",{className:"font-medium text-gray-700",children:"Şifre: AdminTest123!"})]})]})]})})]}),(0,l.jsx)("div",{className:"text-center mt-8 text-green-100",children:(0,l.jsx)("p",{className:"text-sm",children:"\xa9 2024 WhatsApp Manager. T\xfcm hakları saklıdır."})})]})})}function eA(){let[e,s]=(0,t.useState)(!1),[a,i]=(0,t.useState)(null),[r,n]=(0,t.useState)(!0);return((0,t.useEffect)(()=>{let e=async()=>{let e=(0,Z.hP)(),a=(0,Z.bG)();if(e&&a.user_id&&a.email){let l=await (0,Z.Rp)();if(l){let l={access_token:e,refresh_token:localStorage.getItem("refresh_token")||"",token_type:"bearer",user_id:a.user_id,email:a.email,user_type:a.user_type||"user"};i(l),s(!0)}else(0,Z.DH)()}n(!1)};e()},[]),r)?(0,l.jsx)("div",{className:"min-h-screen bg-gradient-to-br from-[#075E54] to-[#128C7E] flex items-center justify-center",children:(0,l.jsxs)("div",{className:"text-center",children:[(0,l.jsx)("div",{className:"animate-spin rounded-full h-12 w-12 border-4 border-white border-t-transparent mx-auto mb-4"}),(0,l.jsx)("p",{className:"text-white text-lg",children:"Y\xfckleniyor..."})]})}):e?(0,l.jsx)(eE,{user:a,onLogout:()=>{(0,Z.DH)(),i(null),s(!1)}}):(0,l.jsx)(eI,{onLogin:e=>{i(e),s(!0)}})}}},function(e){e.O(0,[492,619,891,971,864,744],function(){return e(e.s=3617)}),_N_E=e.O()}]);